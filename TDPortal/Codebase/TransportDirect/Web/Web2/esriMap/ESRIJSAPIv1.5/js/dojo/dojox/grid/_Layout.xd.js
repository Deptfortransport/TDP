/*
	Copyright (c) 2004-2009, The Dojo Foundation All Rights Reserved.
	Available via Academic Free License >= 2.1 OR the modified BSD license.
	see: http://dojotoolkit.org/license for details
*/


dojo._xdResourceLoaded(function(_1,_2,_3){return {depends:[["provide","dojox.grid._Layout"],["require","dojox.grid.cells"],["require","dojox.grid._RowSelector"]],defineResource:function(_4,_5,_6){if(!_4._hasResource["dojox.grid._Layout"]){_4._hasResource["dojox.grid._Layout"]=true;_4.provide("dojox.grid._Layout");_4.require("dojox.grid.cells");_4.require("dojox.grid._RowSelector");_4.declare("dojox.grid._Layout",null,{constructor:function(_7){this.grid=_7;},cells:[],structure:null,defaultWidth:"6em",moveColumn:function(_8,_9,_a,_b,_c){var _d=this.structure[_8].cells[0];var _e=this.structure[_9].cells[0];var _f=null;var _10=0;var _11=0;for(var i=0,c;c=_d[i];i++){if(c.index==_a){_10=i;break;}}_f=_d.splice(_10,1)[0];_f.view=this.grid.views.views[_9];for(i=0,c=null;c=_e[i];i++){if(c.index==_b){_11=i;break;}}if(!_c){_11+=1;}_e.splice(_11,0,_f);var _14=this.grid.getCell(this.grid.getSortIndex());if(_14){_14._currentlySorted=this.grid.getSortAsc();}this.cells=[];var _a=0;for(var i=0,v;v=this.structure[i];i++){for(var j=0,cs;cs=v.cells[j];j++){for(var k=0,c;c=cs[k];k++){c.index=_a;this.cells.push(c);if("_currentlySorted" in c){var si=_a+1;si*=c._currentlySorted?1:-1;this.grid.sortInfo=si;delete c._currentlySorted;}_a++;}}}this.grid.setupHeaderMenu();},setColumnVisibility:function(_1a,_1b){var _1c=this.cells[_1a];if(_1c.hidden==_1b){_1c.hidden=!_1b;var v=_1c.view,w=v.viewWidth;if(w&&w!="auto"){v._togglingColumn=_4.marginBox(_1c.getHeaderNode()).w||0;}v.update();return true;}else{return false;}},addCellDef:function(_1f,_20,_21){var _22=this;var _23=function(_24){var w=0;if(_24.colSpan>1){w=0;}else{w=_24.width||_22._defaultCellProps.width||_22.defaultWidth;if(!isNaN(w)){w=w+"em";}}return w;};var _26={grid:this.grid,subrow:_1f,layoutIndex:_20,index:this.cells.length};if(_21&&_21 instanceof _6.grid.cells._Base){var _27=_4.clone(_21);_26.unitWidth=_23(_27._props);_27=_4.mixin(_27,this._defaultCellProps,_21._props,_26);return _27;}var _28=_21.type||this._defaultCellProps.type||_6.grid.cells.Cell;_26.unitWidth=_23(_21);return new _28(_4.mixin({},this._defaultCellProps,_21,_26));},addRowDef:function(_29,_2a){var _2b=[];var _2c=0,_2d=0,_2e=true;for(var i=0,def,_31;(def=_2a[i]);i++){_31=this.addCellDef(_29,i,def);_2b.push(_31);this.cells.push(_31);if(_2e&&_31.relWidth){_2c+=_31.relWidth;}else{if(_31.width){var w=_31.width;if(typeof w=="string"&&w.slice(-1)=="%"){_2d+=window.parseInt(w,10);}else{if(w=="auto"){_2e=false;}}}}}if(_2c&&_2e){_4.forEach(_2b,function(_33){if(_33.relWidth){_33.width=_33.unitWidth=((_33.relWidth/_2c)*(100-_2d))+"%";}});}return _2b;},addRowsDef:function(_34){var _35=[];if(_4.isArray(_34)){if(_4.isArray(_34[0])){for(var i=0,row;_34&&(row=_34[i]);i++){_35.push(this.addRowDef(i,row));}}else{_35.push(this.addRowDef(0,_34));}}return _35;},addViewDef:function(_38){this._defaultCellProps=_38.defaultCell||{};if(_38.width&&_38.width=="auto"){delete _38.width;}return _4.mixin({},_38,{cells:this.addRowsDef(_38.rows||_38.cells)});},setStructure:function(_39){this.fieldIndex=0;this.cells=[];var s=this.structure=[];if(this.grid.rowSelector){var sel={type:_6._scopeName+".grid._RowSelector"};if(_4.isString(this.grid.rowSelector)){var _3c=this.grid.rowSelector;if(_3c=="false"){sel=null;}else{if(_3c!="true"){sel["width"]=_3c;}}}else{if(!this.grid.rowSelector){sel=null;}}if(sel){s.push(this.addViewDef(sel));}}var _3d=function(def){return ("name" in def||"field" in def||"get" in def);};var _3f=function(def){if(_4.isArray(def)){if(_4.isArray(def[0])||_3d(def[0])){return true;}}return false;};var _41=function(def){return (def!=null&&_4.isObject(def)&&("cells" in def||"rows" in def||("type" in def&&!_3d(def))));};if(_4.isArray(_39)){var _43=false;for(var i=0,st;(st=_39[i]);i++){if(_41(st)){_43=true;break;}}if(!_43){s.push(this.addViewDef({cells:_39}));}else{for(var i=0,st;(st=_39[i]);i++){if(_3f(st)){s.push(this.addViewDef({cells:st}));}else{if(_41(st)){s.push(this.addViewDef(st));}}}}}else{if(_41(_39)){s.push(this.addViewDef(_39));}}this.cellCount=this.cells.length;this.grid.setupHeaderMenu();}});}}};});