/*
	Copyright (c) 2004-2009, The Dojo Foundation All Rights Reserved.
	Available via Academic Free License >= 2.1 OR the modified BSD license.
	see: http://dojotoolkit.org/license for details
*/


dojo._xdResourceLoaded(function(_1,_2,_3){return {depends:[["provide","dojox.rpc.Service"],["require","dojo.AdapterRegistry"]],defineResource:function(_4,_5,_6){if(!_4._hasResource["dojox.rpc.Service"]){_4._hasResource["dojox.rpc.Service"]=true;_4.provide("dojox.rpc.Service");_4.require("dojo.AdapterRegistry");_4.declare("dojox.rpc.Service",null,{constructor:function(_7,_8){var _9;var _a=this;function _b(_c){_c._baseUrl=new _4._Url(location.href,_9||".")+"";_a._smd=_c;for(var _d in _a._smd.services){var _e=_d.split(".");var _f=_a;for(var i=0;i<_e.length-1;i++){_f=_f[_e[i]]||(_f[_e[i]]={});}_f[_e[_e.length-1]]=_a._generateService(_d,_a._smd.services[_d]);}};if(_7){if((_4.isString(_7))||(_7 instanceof _4._Url)){if(_7 instanceof _4._Url){_9=_7+"";}else{_9=_7;}var _11=_4._getText(_9);if(!_11){throw new Error("Unable to load SMD from "+_7);}else{_b(_4.fromJson(_11));}}else{_b(_7);}}this._options=(_8?_8:{});this._requestId=0;},_generateService:function(_12,_13){if(this[_13]){throw new Error("WARNING: "+_12+" already exists for service. Unable to generate function");}_13.name=_12;var _14=_4.hitch(this,"_executeMethod",_13);var _15=_6.rpc.transportRegistry.match(_13.transport||this._smd.transport);if(_15.getExecutor){_14=_15.getExecutor(_14,_13,this);}var _16=_13.returns||(_13._schema={});var _17="/"+_12+"/";_16._service=_14;_14.servicePath=_17;_14._schema=_16;_14.id=_6.rpc.Service._nextId++;return _14;},_getRequest:function(_18,_19){var smd=this._smd;var _1b=_6.rpc.envelopeRegistry.match(_18.envelope||smd.envelope||"NONE");if(_1b.namedParams){if((_19.length==1)&&_4.isObject(_19[0])){_19=_19[0];}else{var _1c={};for(var i=0;i<_18.parameters.length;i++){if(typeof _19[i]!="undefined"||!_18.parameters[i].optional){_1c[_18.parameters[i].name]=_19[i];}}_19=_1c;}var _1e=(_18.parameters||[]).concat(smd.parameters||[]);if(_18.strictParameters||smd.strictParameters){for(i in _19){var _1f=false;for(var j=0;j<_1e.length;j++){if(_1e[i].name==i){_1f=true;}}if(!_1f){delete _19[i];}}}for(i=0;i<_1e.length;i++){var _21=_1e[i];if(!_21.optional&&_21.name&&!_19[_21.name]){if(_21["default"]){_19[_21.name]=_21["default"];}else{if(!(_21.name in _19)){throw new Error("Required parameter "+_21.name+" was omitted");}}}}}else{if(_18.parameters&&_18.parameters[0]&&_18.parameters[0].name&&(_19.length==1)&&_4.isObject(_19[0])){if(_1b.namedParams===false){_19=_6.rpc.toOrdered(_18,_19);}else{_19=_19[0];}}}if(_4.isObject(this._options)){_19=_4.mixin(_19,this._options);}var _22=_18._schema||_18.returns;var _23=_1b.serialize.apply(this,[smd,_18,_19]);_23._envDef=_1b;var _24=(_18.contentType||smd.contentType||_23.contentType);return _4.mixin(_23,{sync:_6.rpc._sync,contentType:_24,headers:{},target:_23.target||_6.rpc.getTarget(smd,_18),transport:_18.transport||smd.transport||_23.transport,envelope:_18.envelope||smd.envelope||_23.envelope,timeout:_18.timeout||smd.timeout,callbackParamName:_18.callbackParamName||smd.callbackParamName,schema:_22,handleAs:_23.handleAs||"auto",preventCache:_18.preventCache||smd.preventCache,frameDoc:this._options.frameDoc||undefined});},_executeMethod:function(_25){var _26=[];var i;for(i=1;i<arguments.length;i++){_26.push(arguments[i]);}var _28=this._getRequest(_25,_26);var _29=_6.rpc.transportRegistry.match(_28.transport).fire(_28);_29.addBoth(function(_2a){return _28._envDef.deserialize.call(this,_2a);});return _29;}});_6.rpc.getTarget=function(smd,_2c){var _2d=smd._baseUrl;if(smd.target){_2d=new _4._Url(_2d,smd.target)+"";}if(_2c.target){_2d=new _4._Url(_2d,_2c.target)+"";}return _2d;};_6.rpc.toOrdered=function(_2e,_2f){if(_4.isArray(_2f)){return _2f;}var _30=[];for(var i=0;i<_2e.parameters.length;i++){_30.push(_2f[_2e.parameters[i].name]);}return _30;};_6.rpc.transportRegistry=new _4.AdapterRegistry(true);_6.rpc.envelopeRegistry=new _4.AdapterRegistry(true);_6.rpc.envelopeRegistry.register("URL",function(str){return str=="URL";},{serialize:function(smd,_34,_35){var d=_4.objectToQuery(_35);return {data:d,transport:"POST"};},deserialize:function(_37){return _37;},namedParams:true});_6.rpc.envelopeRegistry.register("JSON",function(str){return str=="JSON";},{serialize:function(smd,_3a,_3b){var d=_4.toJson(_3b);return {data:d,handleAs:"json",contentType:"application/json"};},deserialize:function(_3d){return _3d;}});_6.rpc.envelopeRegistry.register("PATH",function(str){return str=="PATH";},{serialize:function(smd,_40,_41){var i;var _43=_6.rpc.getTarget(smd,_40);if(_4.isArray(_41)){for(i=0;i<_41.length;i++){_43+="/"+_41[i];}}else{for(i in _41){_43+="/"+i+"/"+_41[i];}}return {data:"",target:_43};},deserialize:function(_44){return _44;}});_6.rpc.transportRegistry.register("POST",function(str){return str=="POST";},{fire:function(r){r.url=r.target;r.postData=r.data;return _4.rawXhrPost(r);}});_6.rpc.transportRegistry.register("GET",function(str){return str=="GET";},{fire:function(r){r.url=r.target+(r.data?"?"+r.data:"");return _4.xhrGet(r);}});_6.rpc.transportRegistry.register("JSONP",function(str){return str=="JSONP";},{fire:function(r){r.url=r.target+((r.target.indexOf("?")==-1)?"?":"&")+r.data;r.callbackParamName=r.callbackParamName||"callback";return _4.io.script.get(r);}});_6.rpc.Service._nextId=1;_4._contentHandlers.auto=function(xhr){var _4c=_4._contentHandlers;var _4d=xhr.getResponseHeader("Content-Type");var _4e=!_4d?_4c.text(xhr):_4d.match(/\/.*json/)?_4c.json(xhr):_4d.match(/\/javascript/)?_4c.javascript(xhr):_4d.match(/\/xml/)?_4c.xml(xhr):_4c.text(xhr);return _4e;};}}};});