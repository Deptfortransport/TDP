/*
	Copyright (c) 2004-2009, The Dojo Foundation All Rights Reserved.
	Available via Academic Free License >= 2.1 OR the modified BSD license.
	see: http://dojotoolkit.org/license for details
*/


dojo._xdResourceLoaded(function(_1,_2,_3){return {depends:[["provide","dijit.Tree"],["require","dojo.fx"],["require","dijit._Widget"],["require","dijit._Templated"],["require","dijit._Container"],["require","dijit._Contained"],["require","dojo.cookie"],["require","dijit.tree.TreeStoreModel"],["require","dijit.tree.ForestStoreModel"]],defineResource:function(_4,_5,_6){if(!_4._hasResource["dijit.Tree"]){_4._hasResource["dijit.Tree"]=true;_4.provide("dijit.Tree");_4.require("dojo.fx");_4.require("dijit._Widget");_4.require("dijit._Templated");_4.require("dijit._Container");_4.require("dijit._Contained");_4.require("dojo.cookie");_4.declare("dijit._TreeNode",[_5._Widget,_5._Templated,_5._Container,_5._Contained],{item:null,isTreeNode:true,label:"",isExpandable:null,isExpanded:false,state:"UNCHECKED",templateString:"<div class=\"dijitTreeNode\" waiRole=\"presentation\"\r\n\t><div dojoAttachPoint=\"rowNode\" class=\"dijitTreeRow\" waiRole=\"presentation\" dojoAttachEvent=\"onmouseenter:_onMouseEnter, onmouseleave:_onMouseLeave\"\r\n\t\t><img src=\"${_blankGif}\" alt=\"\" dojoAttachPoint=\"expandoNode\" class=\"dijitTreeExpando\" waiRole=\"presentation\"\r\n\t\t><span dojoAttachPoint=\"expandoNodeText\" class=\"dijitExpandoText\" waiRole=\"presentation\"\r\n\t\t></span\r\n\t\t><span dojoAttachPoint=\"contentNode\"\r\n\t\t\tclass=\"dijitTreeContent\" waiRole=\"presentation\">\r\n\t\t\t<img src=\"${_blankGif}\" alt=\"\" dojoAttachPoint=\"iconNode\" class=\"dijitTreeIcon\" waiRole=\"presentation\"\r\n\t\t\t><span dojoAttachPoint=\"labelNode\" class=\"dijitTreeLabel\" wairole=\"treeitem\" tabindex=\"-1\" waiState=\"selected-false\" dojoAttachEvent=\"onfocus:_onLabelFocus, onblur:_onLabelBlur\"></span>\r\n\t\t</span\r\n\t></div>\r\n\t<div dojoAttachPoint=\"containerNode\" class=\"dijitTreeContainer\" waiRole=\"presentation\" style=\"display: none;\"></div>\r\n</div>\r\n",postCreate:function(){this.setLabelNode(this.label);this._setExpando();this._updateItemClasses(this.item);if(this.isExpandable){_5.setWaiState(this.labelNode,"expanded",this.isExpanded);if(this==this.tree.rootNode){_5.setWaitState(this.tree.domNode,"expanded",this.isExpanded);}}},_setIndentAttr:function(_7){this.indent=_7;var _8=(Math.max(_7,0)*19)+"px";_4.style(this.domNode,"backgroundPosition",_8+" 0px");_4.style(this.rowNode,_4._isBodyLtr()?"paddingLeft":"paddingRight",_8);_4.forEach(this.getChildren(),function(_9){_9.attr("indent",_7+1);});},markProcessing:function(){this.state="LOADING";this._setExpando(true);},unmarkProcessing:function(){this._setExpando(false);},_updateItemClasses:function(_a){var _b=this.tree,_c=_b.model;if(_b._v10Compat&&_a===_c.root){_a=null;}if(this._iconClass){_4.removeClass(this.iconNode,this._iconClass);}this._iconClass=_b.getIconClass(_a,this.isExpanded);if(this._iconClass){_4.addClass(this.iconNode,this._iconClass);}_4.style(this.iconNode,_b.getIconStyle(_a,this.isExpanded)||{});if(this._labelClass){_4.removeClass(this.labelNode,this._labelClass);}this._labelClass=_b.getLabelClass(_a,this.isExpanded);if(this._labelClass){_4.addClass(this.labelNode,this._labelClass);}_4.style(this.labelNode,_b.getLabelStyle(_a,this.isExpanded)||{});},_updateLayout:function(){var _d=this.getParent();if(!_d||_d.rowNode.style.display=="none"){_4.addClass(this.domNode,"dijitTreeIsRoot");}else{_4.toggleClass(this.domNode,"dijitTreeIsLast",!this.getNextSibling());}},_setExpando:function(_e){var _f=["dijitTreeExpandoLoading","dijitTreeExpandoOpened","dijitTreeExpandoClosed","dijitTreeExpandoLeaf"];var _10=["*","-","+","*"];var idx=_e?0:(this.isExpandable?(this.isExpanded?1:2):3);_4.forEach(_f,function(s){_4.removeClass(this.expandoNode,s);},this);_4.addClass(this.expandoNode,_f[idx]);this.expandoNodeText.innerHTML=_10[idx];},expand:function(){if(this.isExpanded){return;}this._wipeOut&&this._wipeOut.stop();this.isExpanded=true;_5.setWaiState(this.labelNode,"expanded","true");_5.setWaiRole(this.containerNode,"group");_4.addClass(this.contentNode,"dijitTreeContentExpanded");this._setExpando();this._updateItemClasses(this.item);if(this==this.tree.rootNode){_5.setWaiState(this.tree.domNode,"expanded","true");}if(!this._wipeIn){this._wipeIn=_4.fx.wipeIn({node:this.containerNode,duration:_5.defaultDuration});}this._wipeIn.play();},collapse:function(){if(!this.isExpanded){return;}this._wipeIn&&this._wipeIn.stop();this.isExpanded=false;_5.setWaiState(this.labelNode,"expanded","false");if(this==this.tree.rootNode){_5.setWaiState(this.tree.domNode,"expanded","false");}_4.removeClass(this.contentNode,"dijitTreeContentExpanded");this._setExpando();this._updateItemClasses(this.item);if(!this._wipeOut){this._wipeOut=_4.fx.wipeOut({node:this.containerNode,duration:_5.defaultDuration});}this._wipeOut.play();},setLabelNode:function(_13){this.labelNode.innerHTML="";this.labelNode.appendChild(_4.doc.createTextNode(_13));},indent:0,setChildItems:function(_14){var _15=this.tree,_16=_15.model;this.getChildren().forEach(function(_17){_5._Container.prototype.removeChild.call(this,_17);},this);this.state="LOADED";if(_14&&_14.length>0){this.isExpandable=true;_4.forEach(_14,function(_18){var id=_16.getIdentity(_18),_1a=_15._itemNodeMap[id],_1b=(_1a&&!_1a.getParent())?_1a:this.tree._createTreeNode({item:_18,tree:_15,isExpandable:_16.mayHaveChildren(_18),label:_15.getLabel(_18),indent:this.indent+1});if(_1a){_1a.attr("indent",this.indent+1);}this.addChild(_1b);_15._itemNodeMap[id]=_1b;if(this.tree._state(_18)){_15._expandNode(_1b);}},this);_4.forEach(this.getChildren(),function(_1c,idx){_1c._updateLayout();});}else{this.isExpandable=false;}if(this._setExpando){this._setExpando(false);}if(this==_15.rootNode){var fc=this.tree.showRoot?this:this.getChildren()[0];if(fc){fc.setSelected(true);_15.lastFocused=fc;}else{_15.domNode.setAttribute("tabIndex","0");}}},removeChild:function(_1f){this.inherited(arguments);var _20=this.getChildren();if(_20.length==0){this.isExpandable=false;this.collapse();}_4.forEach(_20,function(_21){_21._updateLayout();});},makeExpandable:function(){this.isExpandable=true;this._setExpando(false);},_onLabelFocus:function(evt){_4.addClass(this.labelNode,"dijitTreeLabelFocused");this.tree._onNodeFocus(this);},_onLabelBlur:function(evt){_4.removeClass(this.labelNode,"dijitTreeLabelFocused");},setSelected:function(_24){var _25=this.labelNode;_25.setAttribute("tabIndex",_24?"0":"-1");_5.setWaiState(_25,"selected",_24);_4.toggleClass(this.rowNode,"dijitTreeNodeSelected",_24);},_onMouseEnter:function(evt){_4.addClass(this.rowNode,"dijitTreeNodeHover");this.tree._onNodeMouseEnter(this,evt);},_onMouseLeave:function(evt){_4.removeClass(this.rowNode,"dijitTreeNodeHover");this.tree._onNodeMouseLeave(this,evt);}});_4.declare("dijit.Tree",[_5._Widget,_5._Templated],{store:null,model:null,query:null,label:"",showRoot:true,childrenAttr:["children"],openOnClick:false,openOnDblClick:false,templateString:"<div class=\"dijitTreeContainer\" waiRole=\"tree\"\r\n\tdojoAttachEvent=\"onclick:_onClick,onkeypress:_onKeyPress,ondblclick:_onDblClick\">\r\n</div>\r\n",isExpandable:true,isTree:true,persist:true,dndController:null,dndParams:["onDndDrop","itemCreator","onDndCancel","checkAcceptance","checkItemAcceptance","dragThreshold","betweenThreshold"],onDndDrop:null,itemCreator:null,onDndCancel:null,checkAcceptance:null,checkItemAcceptance:null,dragThreshold:0,betweenThreshold:0,_publish:function(_28,_29){_4.publish(this.id,[_4.mixin({tree:this,event:_28},_29||{})]);},postMixInProperties:function(){this.tree=this;this._itemNodeMap={};if(!this.cookieName){this.cookieName=this.id+"SaveStateCookie";}},postCreate:function(){this._initState();if(!this.model){this._store2model();}this.connect(this.model,"onChange","_onItemChange");this.connect(this.model,"onChildrenChange","_onItemChildrenChange");this.connect(this.model,"onDelete","_onItemDelete");this._load();this.inherited(arguments);if(this.dndController){if(_4.isString(this.dndController)){this.dndController=_4.getObject(this.dndController);}var _2a={};for(var i=0;i<this.dndParams.length;i++){if(this[this.dndParams[i]]){_2a[this.dndParams[i]]=this[this.dndParams[i]];}}this.dndController=new this.dndController(this,_2a);}},_store2model:function(){this._v10Compat=true;_4.deprecated("Tree: from version 2.0, should specify a model object rather than a store/query");var _2c={id:this.id+"_ForestStoreModel",store:this.store,query:this.query,childrenAttrs:this.childrenAttr};if(this.params.mayHaveChildren){_2c.mayHaveChildren=_4.hitch(this,"mayHaveChildren");}if(this.params.getItemChildren){_2c.getChildren=_4.hitch(this,function(_2d,_2e,_2f){this.getItemChildren((this._v10Compat&&_2d===this.model.root)?null:_2d,_2e,_2f);});}this.model=new _5.tree.ForestStoreModel(_2c);this.showRoot=Boolean(this.label);},_load:function(){this.model.getRoot(_4.hitch(this,function(_30){var rn=this.rootNode=this.tree._createTreeNode({item:_30,tree:this,isExpandable:true,label:this.label||this.getLabel(_30),indent:this.showRoot?0:-1});if(!this.showRoot){rn.rowNode.style.display="none";}this.domNode.appendChild(rn.domNode);this._itemNodeMap[this.model.getIdentity(_30)]=rn;rn._updateLayout();this._expandNode(rn);}),function(err){console.error(this,": error loading root: ",err);});},mayHaveChildren:function(_33){},getItemChildren:function(_34,_35){},getLabel:function(_36){return this.model.getLabel(_36);},getIconClass:function(_37,_38){return (!_37||this.model.mayHaveChildren(_37))?(_38?"dijitFolderOpened":"dijitFolderClosed"):"dijitLeaf";},getLabelClass:function(_39,_3a){},getIconStyle:function(_3b,_3c){},getLabelStyle:function(_3d,_3e){},_onKeyPress:function(e){if(e.altKey){return;}var dk=_4.keys;var _41=_5.getEnclosingWidget(e.target);if(!_41){return;}var key=e.charOrCode;if(typeof key=="string"){if(!e.altKey&&!e.ctrlKey&&!e.shiftKey&&!e.metaKey){this._onLetterKeyNav({node:_41,key:key.toLowerCase()});_4.stopEvent(e);}}else{var map=this._keyHandlerMap;if(!map){map={};map[dk.ENTER]="_onEnterKey";map[this.isLeftToRight()?dk.LEFT_ARROW:dk.RIGHT_ARROW]="_onLeftArrow";map[this.isLeftToRight()?dk.RIGHT_ARROW:dk.LEFT_ARROW]="_onRightArrow";map[dk.UP_ARROW]="_onUpArrow";map[dk.DOWN_ARROW]="_onDownArrow";map[dk.HOME]="_onHomeKey";map[dk.END]="_onEndKey";this._keyHandlerMap=map;}if(this._keyHandlerMap[key]){this[this._keyHandlerMap[key]]({node:_41,item:_41.item});_4.stopEvent(e);}}},_onEnterKey:function(_44){this._publish("execute",{item:_44.item,node:_44.node});this.onClick(_44.item,_44.node);},_onDownArrow:function(_45){var _46=this._getNextNode(_45.node);if(_46&&_46.isTreeNode){this.focusNode(_46);}},_onUpArrow:function(_47){var _48=_47.node;var _49=_48.getPreviousSibling();if(_49){_48=_49;while(_48.isExpandable&&_48.isExpanded&&_48.hasChildren()){var _4a=_48.getChildren();_48=_4a[_4a.length-1];}}else{var _4b=_48.getParent();if(!(!this.showRoot&&_4b===this.rootNode)){_48=_4b;}}if(_48&&_48.isTreeNode){this.focusNode(_48);}},_onRightArrow:function(_4c){var _4d=_4c.node;if(_4d.isExpandable&&!_4d.isExpanded){this._expandNode(_4d);}else{if(_4d.hasChildren()){_4d=_4d.getChildren()[0];if(_4d&&_4d.isTreeNode){this.focusNode(_4d);}}}},_onLeftArrow:function(_4e){var _4f=_4e.node;if(_4f.isExpandable&&_4f.isExpanded){this._collapseNode(_4f);}else{var _50=_4f.getParent();if(_50&&_50.isTreeNode&&!(!this.showRoot&&_50===this.rootNode)){this.focusNode(_50);}}},_onHomeKey:function(){var _51=this._getRootOrFirstNode();if(_51){this.focusNode(_51);}},_onEndKey:function(_52){var _53=this.rootNode;while(_53.isExpanded){var c=_53.getChildren();_53=c[c.length-1];}if(_53&&_53.isTreeNode){this.focusNode(_53);}},_onLetterKeyNav:function(_55){var _56=_55.node,_57=_56,key=_55.key;do{_56=this._getNextNode(_56);if(!_56){_56=this._getRootOrFirstNode();}}while(_56!==_57&&(_56.label.charAt(0).toLowerCase()!=key));if(_56&&_56.isTreeNode){if(_56!==_57){this.focusNode(_56);}}},_onClick:function(e){var _5a=e.target;var _5b=_5.getEnclosingWidget(_5a);if(!_5b||!_5b.isTreeNode){return;}if((this.openOnClick&&_5b.isExpandable)||(_5a==_5b.expandoNode||_5a==_5b.expandoNodeText)){if(_5b.isExpandable){this._onExpandoClick({node:_5b});}}else{this._publish("execute",{item:_5b.item,node:_5b});this.onClick(_5b.item,_5b);this.focusNode(_5b);}_4.stopEvent(e);},_onDblClick:function(e){var _5d=e.target;var _5e=_5.getEnclosingWidget(_5d);if(!_5e||!_5e.isTreeNode){return;}if((this.openOnDblClick&&_5e.isExpandable)||(_5d==_5e.expandoNode||_5d==_5e.expandoNodeText)){if(_5e.isExpandable){this._onExpandoClick({node:_5e});}}else{this._publish("execute",{item:_5e.item,node:_5e});this.onDblClick(_5e.item,_5e);this.focusNode(_5e);}_4.stopEvent(e);},_onExpandoClick:function(_5f){var _60=_5f.node;this.focusNode(_60);if(_60.isExpanded){this._collapseNode(_60);}else{this._expandNode(_60);}},onClick:function(_61,_62){},onDblClick:function(_63,_64){},onOpen:function(_65,_66){},onClose:function(_67,_68){},_getNextNode:function(_69){if(_69.isExpandable&&_69.isExpanded&&_69.hasChildren()){return _69.getChildren()[0];}else{while(_69&&_69.isTreeNode){var _6a=_69.getNextSibling();if(_6a){return _6a;}_69=_69.getParent();}return null;}},_getRootOrFirstNode:function(){return this.showRoot?this.rootNode:this.rootNode.getChildren()[0];},_collapseNode:function(_6b){if(_6b.isExpandable){if(_6b.state=="LOADING"){return;}_6b.collapse();this.onClose(_6b.item,_6b);if(_6b.item){this._state(_6b.item,false);this._saveState();}}},_expandNode:function(_6c){if(!_6c.isExpandable){return;}var _6d=this.model,_6e=_6c.item;switch(_6c.state){case "LOADING":return;case "UNCHECKED":_6c.markProcessing();var _6f=this;_6d.getChildren(_6e,function(_70){_6c.unmarkProcessing();_6c.setChildItems(_70);_6f._expandNode(_6c);},function(err){console.error(_6f,": error loading root children: ",err);});break;default:_6c.expand();this.onOpen(_6c.item,_6c);if(_6e){this._state(_6e,true);this._saveState();}}},focusNode:function(_72){_72.labelNode.focus();},_onNodeFocus:function(_73){if(_73){if(_73!=this.lastFocused){this.lastFocused.setSelected(false);}_73.setSelected(true);this.lastFocused=_73;}},_onNodeMouseEnter:function(_74){},_onNodeMouseLeave:function(_75){},_onItemChange:function(_76){var _77=this.model,_78=_77.getIdentity(_76),_79=this._itemNodeMap[_78];if(_79){_79.setLabelNode(this.getLabel(_76));_79._updateItemClasses(_76);}},_onItemChildrenChange:function(_7a,_7b){var _7c=this.model,_7d=_7c.getIdentity(_7a),_7e=this._itemNodeMap[_7d];if(_7e){_7e.setChildItems(_7b);}},_onItemDelete:function(_7f){var _80=this.model,_81=_80.getIdentity(_7f),_82=this._itemNodeMap[_81];if(_82){var _83=_82.getParent();if(_83){_83.removeChild(_82);}_82.destroyRecursive();delete this._itemNodeMap[_81];}},_initState:function(){if(this.persist){var _84=_4.cookie(this.cookieName);this._openedItemIds={};if(_84){_4.forEach(_84.split(","),function(_85){this._openedItemIds[_85]=true;},this);}}},_state:function(_86,_87){if(!this.persist){return false;}var id=this.model.getIdentity(_86);if(arguments.length===1){return this._openedItemIds[id];}if(_87){this._openedItemIds[id]=true;}else{delete this._openedItemIds[id];}},_saveState:function(){if(!this.persist){return;}var ary=[];for(var id in this._openedItemIds){ary.push(id);}_4.cookie(this.cookieName,ary.join(","),{expires:365});},destroy:function(){if(this.rootNode){this.rootNode.destroyRecursive();}if(this.dndController&&!_4.isString(this.dndController)){this.dndController.destroy();}this.rootNode=null;this.inherited(arguments);},destroyRecursive:function(){this.destroy();},_createTreeNode:function(_8b){return new _5._TreeNode(_8b);}});_4.require("dijit.tree.TreeStoreModel");_4.require("dijit.tree.ForestStoreModel");}}};});