/*
	Copyright (c) 2004-2009, The Dojo Foundation All Rights Reserved.
	Available via Academic Free License >= 2.1 OR the modified BSD license.
	see: http://dojotoolkit.org/license for details
*/


dojo._xdResourceLoaded(function(_1,_2,_3){return {depends:[["provide","dijit._editor.plugins.LinkDialog"],["require","dijit._Widget"],["require","dijit._Templated"],["require","dijit._editor._Plugin"],["require","dijit.TooltipDialog"],["require","dijit.form.Button"],["require","dijit.form.ValidationTextBox"],["require","dojo.i18n"],["require","dojo.string"],["requireLocalization","dijit._editor","LinkDialog",null,"ROOT,ar,ca,cs,da,de,el,es,fi,fr,he,hu,it,ja,ko,nb,nl,pl,pt,pt-pt,ru,sk,sl,sv,th,tr,zh,zh-tw","ROOT,ar,ca,cs,da,de,el,es,fi,fr,he,hu,it,ja,ko,nb,nl,pl,pt,pt-pt,ru,sk,sl,sv,th,tr,zh,zh-tw"]],defineResource:function(_4,_5,_6){if(!_4._hasResource["dijit._editor.plugins.LinkDialog"]){_4._hasResource["dijit._editor.plugins.LinkDialog"]=true;_4.provide("dijit._editor.plugins.LinkDialog");_4.require("dijit._Widget");_4.require("dijit._Templated");_4.require("dijit._editor._Plugin");_4.require("dijit.TooltipDialog");_4.require("dijit.form.Button");_4.require("dijit.form.ValidationTextBox");_4.require("dojo.i18n");_4.require("dojo.string");_4.declare("dijit._editor.plugins.LinkDialog",_5._editor._Plugin,{buttonClass:_5.form.DropDownButton,useDefaultCommand:false,urlRegExp:"((https?|ftps?)\\://|)(((?:(?:[\\da-zA-Z](?:[-\\da-zA-Z]{0,61}[\\da-zA-Z])?)\\.)*(?:[a-zA-Z](?:[-\\da-zA-Z]{0,6}[\\da-zA-Z])?)\\.?)|(((\\d|[1-9]\\d|1\\d\\d|2[0-4]\\d|25[0-5])\\.){3}(\\d|[1-9]\\d|1\\d\\d|2[0-4]\\d|25[0-5])|(0[xX]0*[\\da-fA-F]?[\\da-fA-F]\\.){3}0[xX]0*[\\da-fA-F]?[\\da-fA-F]|(0+[0-3][0-7][0-7]\\.){3}0+[0-3][0-7][0-7]|(0|[1-9]\\d{0,8}|[1-3]\\d{9}|4[01]\\d{8}|42[0-8]\\d{7}|429[0-3]\\d{6}|4294[0-8]\\d{5}|42949[0-5]\\d{4}|429496[0-6]\\d{3}|4294967[01]\\d{2}|42949672[0-8]\\d|429496729[0-5])|0[xX]0*[\\da-fA-F]{1,8}|([\\da-fA-F]{1,4}\\:){7}[\\da-fA-F]{1,4}|([\\da-fA-F]{1,4}\\:){6}((\\d|[1-9]\\d|1\\d\\d|2[0-4]\\d|25[0-5])\\.){3}(\\d|[1-9]\\d|1\\d\\d|2[0-4]\\d|25[0-5])))(\\:\\d+)?(/(?:[^?#\\s/]+/)*(?:[^?#\\s/]+(?:\\?[^?#\\s/]*)?(?:#[A-Za-z][\\w.:-]*)?)?)?",linkDialogTemplate:["<table><tr><td>","<label for='${id}_urlInput'>${url}</label>","</td><td>","<input dojoType='dijit.form.ValidationTextBox' regExp='${urlRegExp}' required='true' id='${id}_urlInput' name='urlInput'>","</td></tr><tr><td>","<label for='${id}_textInput'>${text}</label>","</td><td>","<input dojoType='dijit.form.ValidationTextBox' required='true' id='${id}_textInput' name='textInput'>","</td></tr><tr><td colspan='2'>","<button dojoType='dijit.form.Button' type='submit'>${set}</button>","</td></tr></table>"].join(""),_initButton:function(){var _7=this;this.tag=this.command=="insertImage"?"img":"a";var _8=_4.i18n.getLocalization("dijit._editor","LinkDialog",this.lang);var _9=(this.dropDown=new _5.TooltipDialog({title:_8[this.command+"Title"],execute:_4.hitch(this,"setValue"),onOpen:function(){_7._onOpenDialog();_5.TooltipDialog.prototype.onOpen.apply(this,arguments);},onCancel:function(){setTimeout(_4.hitch(_7,"_onCloseDialog"),0);},onClose:_4.hitch(this,"_onCloseDialog")}));_8.urlRegExp=this.urlRegExp;_8.id=_5.getUniqueId(this.editor.id);this._setContent(_9.title+"<div style='border-bottom: 1px black solid;padding-bottom:2pt;margin-bottom:4pt'></div>"+_4.string.substitute(this.linkDialogTemplate,_8));_9.startup();this.inherited(arguments);},_setContent:function(_a){this.dropDown.attr("content",_a);},setValue:function(_b){this._onCloseDialog();if(_4.isIE){var a=_4.withGlobal(this.editor.window,"getAncestorElement",_5._editor.selection,[this.tag]);if(a){_4.withGlobal(this.editor.window,"selectElement",_5._editor.selection,[a]);}}_b.tag=this.tag;_b.refAttr=this.tag=="img"?"src":"href";var _d="<${tag} ${refAttr}='${urlInput}' _djrealurl='${urlInput}'"+(_b.tag=="img"?" alt='${textInput}'>":">${textInput}")+"</${tag}>";this.editor.execCommand("inserthtml",_4.string.substitute(_d,_b));},_onCloseDialog:function(){this.editor.focus();},_onOpenDialog:function(){var a=_4.withGlobal(this.editor.window,"getAncestorElement",_5._editor.selection,[this.tag]);var _f,_10;if(a){_f=a.getAttribute("_djrealurl");_10=this.tag=="img"?a.getAttribute("alt"):a.textContent||a.innerText;_4.withGlobal(this.editor.window,"selectElement",_5._editor.selection,[a,true]);}else{_10=_4.withGlobal(this.editor.window,_5._editor.selection.getSelectedText);}this.dropDown.reset();this.dropDown.setValues({urlInput:_f||"",textInput:_10||""});}});_4.subscribe(_5._scopeName+".Editor.getPlugin",null,function(o){if(o.plugin){return;}switch(o.args.name){case "createLink":case "insertImage":o.plugin=new _5._editor.plugins.LinkDialog({command:o.args.name});}});}}};});