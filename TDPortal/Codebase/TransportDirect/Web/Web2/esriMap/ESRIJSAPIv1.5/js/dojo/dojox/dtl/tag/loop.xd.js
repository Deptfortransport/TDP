/*
	Copyright (c) 2004-2009, The Dojo Foundation All Rights Reserved.
	Available via Academic Free License >= 2.1 OR the modified BSD license.
	see: http://dojotoolkit.org/license for details
*/


dojo._xdResourceLoaded(function(_1,_2,_3){return {depends:[["provide","dojox.dtl.tag.loop"],["require","dojox.dtl._base"],["require","dojox.string.tokenize"]],defineResource:function(_4,_5,_6){if(!_4._hasResource["dojox.dtl.tag.loop"]){_4._hasResource["dojox.dtl.tag.loop"]=true;_4.provide("dojox.dtl.tag.loop");_4.require("dojox.dtl._base");_4.require("dojox.string.tokenize");(function(){var dd=_6.dtl;var _8=dd.tag.loop;_8.CycleNode=_4.extend(function(_9,_a,_b,_c){this.cyclevars=_9;this.name=_a;this.contents=_b;this.shared=_c||{counter:-1,map:{}};},{render:function(_d,_e){if(_d.forloop&&!_d.forloop.counter0){this.shared.counter=-1;}++this.shared.counter;var _f=this.cyclevars[this.shared.counter%this.cyclevars.length];var map=this.shared.map;if(!map[_f]){map[_f]=new dd._Filter(_f);}_f=map[_f].resolve(_d,_e);if(this.name){_d[this.name]=_f;}this.contents.set(_f);return this.contents.render(_d,_e);},unrender:function(_11,_12){return this.contents.unrender(_11,_12);},clone:function(_13){return new this.constructor(this.cyclevars,this.name,this.contents.clone(_13),this.shared);}});_8.IfChangedNode=_4.extend(function(_14,_15,_16){this.nodes=_14;this._vars=_15;this.shared=_16||{last:null,counter:0};this.vars=_4.map(_15,function(_17){return new _6.dtl._Filter(_17);});},{render:function(_18,_19){if(_18.forloop){if(_18.forloop.counter<=this.shared.counter){this.shared.last=null;}this.shared.counter=_18.forloop.counter;}var _1a;if(this.vars.length){_1a=_4.toJson(_4.map(this.vars,function(_1b){return _1b.resolve(_18);}));}else{_1a=this.nodes.dummyRender(_18,_19);}if(_1a!=this.shared.last){var _1c=(this.shared.last===null);this.shared.last=_1a;_18=_18.push();_18.ifchanged={firstloop:_1c};_19=this.nodes.render(_18,_19);_18=_18.pop();}else{_19=this.nodes.unrender(_18,_19);}return _19;},unrender:function(_1d,_1e){return this.nodes.unrender(_1d,_1e);},clone:function(_1f){return new this.constructor(this.nodes.clone(_1f),this._vars,this.shared);}});_8.RegroupNode=_4.extend(function(_20,key,_22){this._expression=_20;this.expression=new dd._Filter(_20);this.key=key;this.alias=_22;},{_push:function(_23,_24,_25){if(_25.length){_23.push({grouper:_24,list:_25});}},render:function(_26,_27){_26[this.alias]=[];var _28=this.expression.resolve(_26);if(_28){var _29=null;var _2a=[];for(var i=0;i<_28.length;i++){var id=_28[i][this.key];if(_29!==id){this._push(_26[this.alias],_29,_2a);_29=id;_2a=[_28[i]];}else{_2a.push(_28[i]);}}this._push(_26[this.alias],_29,_2a);}return _27;},unrender:function(_2d,_2e){return _2e;},clone:function(_2f,_30){return this;}});_4.mixin(_8,{cycle:function(_31,_32){var _33=_32.split_contents();if(_33.length<2){throw new Error("'cycle' tag requires at least two arguments");}if(_33[1].indexOf(",")!=-1){var _34=_33[1].split(",");_33=[_33[0]];for(var i=0;i<_34.length;i++){_33.push("\""+_34[i]+"\"");}}if(_33.length==2){var _36=_33[_33.length-1];if(!_31._namedCycleNodes){throw new Error("No named cycles in template: '"+_36+"' is not defined");}if(!_31._namedCycleNodes[_36]){throw new Error("Named cycle '"+_36+"' does not exist");}return _31._namedCycleNodes[_36];}if(_33.length>4&&_33[_33.length-2]=="as"){var _36=_33[_33.length-1];var _37=new _8.CycleNode(_33.slice(1,_33.length-2),_36,_31.create_text_node());if(!_31._namedCycleNodes){_31._namedCycleNodes={};}_31._namedCycleNodes[_36]=_37;}else{_37=new _8.CycleNode(_33.slice(1),null,_31.create_text_node());}return _37;},ifchanged:function(_38,_39){var _3a=_39.contents.split();var _3b=_38.parse(["endifchanged"]);_38.delete_first_token();return new _8.IfChangedNode(_3b,_3a.slice(1));},regroup:function(_3c,_3d){var _3e=_6.string.tokenize(_3d.contents,/(\s+)/g,function(_3f){return _3f;});if(_3e.length<11||_3e[_3e.length-3]!="as"||_3e[_3e.length-7]!="by"){throw new Error("Expected the format: regroup list by key as newList");}var _40=_3e.slice(2,-8).join("");var key=_3e[_3e.length-5];var _42=_3e[_3e.length-1];return new _8.RegroupNode(_40,key,_42);}});})();}}};});