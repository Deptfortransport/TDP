/*
	Copyright (c) 2004-2009, The Dojo Foundation All Rights Reserved.
	Available via Academic Free License >= 2.1 OR the modified BSD license.
	see: http://dojotoolkit.org/license for details
*/


dojo._xdResourceLoaded(function(_1,_2,_3){return {depends:[["provide","dojox.storage.FlashStorageProvider"],["require","dojox.flash"],["require","dojox.storage.manager"],["require","dojox.storage.Provider"]],defineResource:function(_4,_5,_6){if(!_4._hasResource["dojox.storage.FlashStorageProvider"]){_4._hasResource["dojox.storage.FlashStorageProvider"]=true;_4.provide("dojox.storage.FlashStorageProvider");_4.require("dojox.flash");_4.require("dojox.storage.manager");_4.require("dojox.storage.Provider");_4.declare("dojox.storage.FlashStorageProvider",_6.storage.Provider,{initialized:false,_available:null,_statusHandler:null,_flashReady:false,_pageReady:false,initialize:function(){if(_4.config["disableFlashStorage"]==true){return;}_6.flash.addLoadedListener(_4.hitch(this,function(){this._flashReady=true;if(this._flashReady&&this._pageReady){this._loaded();}}));var _7=_4.moduleUrl("dojox","storage/Storage.swf").toString();_6.flash.setSwf(_7,false);_4.connect(_4,"loaded",this,function(){this._pageReady=true;if(this._flashReady&&this._pageReady){this._loaded();}});},setFlushDelay:function(_8){if(_8===null||typeof _8==="undefined"||isNaN(_8)){throw new Error("Invalid argunment: "+_8);}_6.flash.comm.setFlushDelay(String(_8));},getFlushDelay:function(){return Number(_6.flash.comm.getFlushDelay());},flush:function(_9){if(_9==null||typeof _9=="undefined"){_9=_6.storage.DEFAULT_NAMESPACE;}_6.flash.comm.flush(_9);},isAvailable:function(){return (this._available=!_4.config["disableFlashStorage"]);},put:function(_a,_b,_c,_d){if(!this.isValidKey(_a)){throw new Error("Invalid key given: "+_a);}if(!_d){_d=_6.storage.DEFAULT_NAMESPACE;}if(!this.isValidKey(_d)){throw new Error("Invalid namespace given: "+_d);}this._statusHandler=_c;if(_4.isString(_b)){_b="string:"+_b;}else{_b=_4.toJson(_b);}_6.flash.comm.put(_a,_b,_d);},putMultiple:function(_e,_f,_10,_11){if(!this.isValidKeyArray(_e)||!_f instanceof Array||_e.length!=_f.length){throw new Error("Invalid arguments: keys = ["+_e+"], values = ["+_f+"]");}if(!_11){_11=_6.storage.DEFAULT_NAMESPACE;}if(!this.isValidKey(_11)){throw new Error("Invalid namespace given: "+_11);}this._statusHandler=_10;var _12=_e.join(",");var _13=[];for(var i=0;i<_f.length;i++){if(_4.isString(_f[i])){_f[i]="string:"+_f[i];}else{_f[i]=_4.toJson(_f[i]);}_13[i]=_f[i].length;}var _15=_f.join("");var _16=_13.join(",");_6.flash.comm.putMultiple(_12,_15,_16,_11);},get:function(key,_18){if(!this.isValidKey(key)){throw new Error("Invalid key given: "+key);}if(!_18){_18=_6.storage.DEFAULT_NAMESPACE;}if(!this.isValidKey(_18)){throw new Error("Invalid namespace given: "+_18);}var _19=_6.flash.comm.get(key,_18);if(_19==""){return null;}return this._destringify(_19);},getMultiple:function(_1a,_1b){if(!this.isValidKeyArray(_1a)){throw new ("Invalid key array given: "+_1a);}if(!_1b){_1b=_6.storage.DEFAULT_NAMESPACE;}if(!this.isValidKey(_1b)){throw new Error("Invalid namespace given: "+_1b);}var _1c=_1a.join(",");var _1d=_6.flash.comm.getMultiple(_1c,_1b);var _1e=eval("("+_1d+")");for(var i=0;i<_1e.length;i++){_1e[i]=(_1e[i]=="")?null:this._destringify(_1e[i]);}return _1e;},_destringify:function(_20){if(_4.isString(_20)&&(/^string:/.test(_20))){_20=_20.substring("string:".length);}else{_20=_4.fromJson(_20);}return _20;},getKeys:function(_21){if(!_21){_21=_6.storage.DEFAULT_NAMESPACE;}if(!this.isValidKey(_21)){throw new Error("Invalid namespace given: "+_21);}var _22=_6.flash.comm.getKeys(_21);if(_22==null||_22=="null"){_22="";}_22=_22.split(",");_22.sort();return _22;},getNamespaces:function(){var _23=_6.flash.comm.getNamespaces();if(_23==null||_23=="null"){_23=_6.storage.DEFAULT_NAMESPACE;}_23=_23.split(",");_23.sort();return _23;},clear:function(_24){if(!_24){_24=_6.storage.DEFAULT_NAMESPACE;}if(!this.isValidKey(_24)){throw new Error("Invalid namespace given: "+_24);}_6.flash.comm.clear(_24);},remove:function(key,_26){if(!_26){_26=_6.storage.DEFAULT_NAMESPACE;}if(!this.isValidKey(_26)){throw new Error("Invalid namespace given: "+_26);}_6.flash.comm.remove(key,_26);},removeMultiple:function(_27,_28){if(!this.isValidKeyArray(_27)){_4.raise("Invalid key array given: "+_27);}if(!_28){_28=_6.storage.DEFAULT_NAMESPACE;}if(!this.isValidKey(_28)){throw new Error("Invalid namespace given: "+_28);}var _29=_27.join(",");_6.flash.comm.removeMultiple(_29,_28);},isPermanent:function(){return true;},getMaximumSize:function(){return _6.storage.SIZE_NO_LIMIT;},hasSettingsUI:function(){return true;},showSettingsUI:function(){_6.flash.comm.showSettings();_6.flash.obj.setVisible(true);_6.flash.obj.center();},hideSettingsUI:function(){_6.flash.obj.setVisible(false);if(_4.isFunction(_6.storage.onHideSettingsUI)){_6.storage.onHideSettingsUI.call(null);}},getResourceList:function(){return [];},_loaded:function(){this._allNamespaces=this.getNamespaces();this.initialized=true;_6.storage.manager.loaded();},_onStatus:function(_2a,key,_2c){var ds=_6.storage;var dfo=_6.flash.obj;if(_2a==ds.PENDING){dfo.center();dfo.setVisible(true);}else{dfo.setVisible(false);}if(ds._statusHandler){ds._statusHandler.call(null,_2a,key,null,_2c);}}});_6.storage.manager.register("dojox.storage.FlashStorageProvider",new _6.storage.FlashStorageProvider());}}};});