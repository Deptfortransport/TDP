/*
	Copyright (c) 2004-2009, The Dojo Foundation All Rights Reserved.
	Available via Academic Free License >= 2.1 OR the modified BSD license.
	see: http://dojotoolkit.org/license for details
*/


dojo._xdResourceLoaded(function(_1,_2,_3){return {depends:[["provide","dojox.layout.ResizeHandle"],["require","dijit._Widget"],["require","dijit._Templated"],["require","dojo.fx"]],defineResource:function(_4,_5,_6){if(!_4._hasResource["dojox.layout.ResizeHandle"]){_4._hasResource["dojox.layout.ResizeHandle"]=true;_4.provide("dojox.layout.ResizeHandle");_4.experimental("dojox.layout.ResizeHandle");_4.require("dijit._Widget");_4.require("dijit._Templated");_4.require("dojo.fx");_4.declare("dojox.layout.ResizeHandle",[_5._Widget,_5._Templated],{targetId:"",targetContainer:null,resizeAxis:"xy",activeResize:false,activeResizeClass:"dojoxResizeHandleClone",animateSizing:true,animateMethod:"chain",animateDuration:225,minHeight:100,minWidth:100,constrainMax:false,maxHeight:0,maxWidth:0,fixedAspect:false,intermediateChanges:false,templateString:"<div dojoAttachPoint=\"resizeHandle\" class=\"dojoxResizeHandle\"><div></div></div>",postCreate:function(){this.connect(this.resizeHandle,"onmousedown","_beginSizing");if(!this.activeResize){this._resizeHelper=_5.byId("dojoxGlobalResizeHelper");if(!this._resizeHelper){this._resizeHelper=new _6.layout._ResizeHelper({id:"dojoxGlobalResizeHelper"}).placeAt(_4.body());_4.addClass(this._resizeHelper.domNode,this.activeResizeClass);}}else{this.animateSizing=false;}if(!this.minSize){this.minSize={w:this.minWidth,h:this.minHeight};}if(this.constrainMax){this.maxSize={w:this.maxWidth,h:this.maxHeight};}this._resizeX=this._resizeY=false;var _7=_4.partial(_4.addClass,this.resizeHandle);switch(this.resizeAxis.toLowerCase()){case "xy":this._resizeX=this._resizeY=true;_7("dojoxResizeNW");break;case "x":this._resizeX=true;_7("dojoxResizeW");break;case "y":this._resizeY=true;_7("dojoxResizeN");break;}},_beginSizing:function(e){if(this._isSizing){return false;}this.targetWidget=_5.byId(this.targetId);this.targetDomNode=this.targetWidget?this.targetWidget.domNode:_4.byId(this.targetId);if(this.targetContainer){this.targetDomNode=this.targetContainer;}if(!this.targetDomNode){return false;}if(!this.activeResize){var c=_4.coords(this.targetDomNode,true);this._resizeHelper.resize({l:c.x,t:c.y,w:c.w,h:c.h});this._resizeHelper.show();}this._isSizing=true;this.startPoint={x:e.clientX,y:e.clientY};var mb=this.targetWidget?_4.marginBox(this.targetDomNode):_4.contentBox(this.targetDomNode);this.startSize={w:mb.w,h:mb.h};if(this.fixedAspect){var _b,_c;if(mb.w>mb.h){_b="w";_c=mb.w/mb.h;}else{_b="h";_c=mb.h/mb.w;}this._aspect={prop:_b};this._aspect[_b]=_c;}this._pconnects=[];this._pconnects.push(_4.connect(_4.doc,"onmousemove",this,"_updateSizing"));this._pconnects.push(_4.connect(_4.doc,"onmouseup",this,"_endSizing"));_4.stopEvent(e);},_updateSizing:function(e){if(this.activeResize){this._changeSizing(e);}else{var _e=this._getNewCoords(e);if(_e===false){return;}this._resizeHelper.resize(_e);}e.preventDefault();},_getNewCoords:function(e){try{if(!e.clientX||!e.clientY){return false;}}catch(e){return false;}this._activeResizeLastEvent=e;var dx=this.startPoint.x-e.clientX,dy=this.startPoint.y-e.clientY,_12=this.startSize.w-(this._resizeX?dx:0),_13=this.startSize.h-(this._resizeY?dy:0);return this._checkConstraints(_12,_13);},_checkConstraints:function(_14,_15){if(this.minSize){var tm=this.minSize;if(_14<tm.w){_14=tm.w;}if(_15<tm.h){_15=tm.h;}}if(this.constrainMax&&this.maxSize){var ms=this.maxSize;if(_14>ms.w){_14=ms.w;}if(_15>ms.h){_15=ms.h;}}if(this.fixedAspect){var ta=this._aspect[this._aspect.prop];if(_14<_15){_15=_14*ta;}else{if(_15<_14){_14=_15*ta;}}}return {w:_14,h:_15};},_changeSizing:function(e){var tmp=this._getNewCoords(e);if(tmp===false){return;}if(this.targetWidget&&_4.isFunction(this.targetWidget.resize)){this.targetWidget.resize(tmp);}else{if(this.animateSizing){var _1b=_4.fx[this.animateMethod]([_4.animateProperty({node:this.targetDomNode,properties:{width:{start:this.startSize.w,end:tmp.w,unit:"px"}},duration:this.animateDuration}),_4.animateProperty({node:this.targetDomNode,properties:{height:{start:this.startSize.h,end:tmp.h,unit:"px"}},duration:this.animateDuration})]);_1b.play();}else{_4.style(this.targetDomNode,{width:tmp.w+"px",height:tmp.h+"px"});}}if(this.intermediateChanges){this.onResize(e);}},_endSizing:function(e){_4.forEach(this._pconnects,_4.disconnect);if(!this.activeResize){this._resizeHelper.hide();this._changeSizing(e);}this._isSizing=false;this.onResize(e);},onResize:function(e){}});_4.declare("dojox.layout._ResizeHelper",_5._Widget,{show:function(){_4.fadeIn({node:this.domNode,duration:120,beforeBegin:_4.partial(_4.style,this.domNode,"display","")}).play();},hide:function(){_4.fadeOut({node:this.domNode,duration:250,onEnd:_4.partial(_4.style,this.domNode,"display","none")}).play();},resize:function(dim){_4.marginBox(this.domNode,dim);}});}}};});