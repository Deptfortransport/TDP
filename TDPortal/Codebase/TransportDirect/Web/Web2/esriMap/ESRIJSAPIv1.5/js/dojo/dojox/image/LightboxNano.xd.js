/*
	Copyright (c) 2004-2009, The Dojo Foundation All Rights Reserved.
	Available via Academic Free License >= 2.1 OR the modified BSD license.
	see: http://dojotoolkit.org/license for details
*/


dojo._xdResourceLoaded(function(_1,_2,_3){return {depends:[["provide","dojox.image.LightboxNano"],["require","dojo.fx"]],defineResource:function(_4,_5,_6){if(!_4._hasResource["dojox.image.LightboxNano"]){_4._hasResource["dojox.image.LightboxNano"]=true;_4.provide("dojox.image.LightboxNano");_4.require("dojo.fx");(function(d){var _8=function(){var _9=(d.doc.compatMode=="BackCompat")?d.body():d.doc.documentElement,_a=_4._docScroll();return {w:_9.clientWidth,h:_9.clientHeight,l:_a.x,t:_a.y};},_b="absolute";d.declare("dojox.image.LightboxNano",null,{href:"",duration:500,preloadDelay:5000,constructor:function(p,n){var _e=this;d.mixin(_e,p);n=_4.byId(n);if(!/a/i.test(n.tagName)){var a=d.create("a",{href:_e.href,"class":n.className},n,"after");n.className="";a.appendChild(n);n=a;}d.style(n,{display:"block",position:"relative"});_e._createDiv("dojoxEnlarge",n);_e._node=n;d.setSelectable(n,false);_e._onClickEvt=d.connect(n,"onclick",_e,"_load");setTimeout(function(){(new Image()).src=_e.href;_e._hideLoading();},_e.preloadDelay);},destroy:function(){var a=this._connects||[];a.push(this._onClickEvt);d.forEach(a,d.disconnect);d.destroy(this._node);},_createDiv:function(_11,_12,_13){return d.create("div",{"class":_11,style:{position:_b,display:_13?"":"none"}},_12);},_load:function(e){var _15=this;d.stopEvent(e);if(!_15._loading){_15._loading=true;_15._reset();var n=d.query("img",_15._node)[0],a=d._abs(n,true),c=d.contentBox(n),b=d._getBorderExtents(n),i=_15._img=d.create("img",{style:{visibility:"hidden",cursor:"pointer",position:_b,top:0,left:0,zIndex:9999999}},d.body()),ln=_15._loadingNode;if(ln==null){_15._loadingNode=ln=_15._createDiv("dojoxLoading",_15._node,true);var l=d.marginBox(ln);d.style(ln,{left:parseInt((c.w-l.w)/2)+"px",top:parseInt((c.h-l.h)/2)+"px"});}c.x=a.x-10+b.l;c.y=a.y-10+b.t;_15._start=c;_15._connects=[d.connect(i,"onload",_15,"_show")];i.src=_15.href;}},_hideLoading:function(){if(this._loadingNode){d.style(this._loadingNode,"display","none");}this._loadingNode=false;},_show:function(){var _1d=this,vp=_8(),w=_1d._img.width,h=_1d._img.height,vpw=parseInt((vp.w-20)*0.9),vph=parseInt((vp.h-20)*0.9),dd=d.doc,bg=_1d._bg=d.create("div",{style:{backgroundColor:"#000",opacity:0,position:_b,zIndex:9999998}},d.body()),ln=_1d._loadingNode;if(_1d._loadingNode){_1d._hideLoading();}d.style(_1d._img,{border:"10px solid #fff",visibility:"visible"});d.style(_1d._node,"visibility","hidden");_1d._loading=false;_1d._connects=_1d._connects.concat([d.connect(dd,"onmousedown",_1d,"_hide"),d.connect(dd,"onkeypress",_1d,"_key"),d.connect(window,"onresize",_1d,"_sizeBg")]);if(w>vpw){h=h*vpw/w;w=vpw;}if(h>vph){w=w*vph/h;h=vph;}_1d._end={x:(vp.w-20-w)/2+vp.l,y:(vp.h-20-h)/2+vp.t,w:w,h:h};_1d._sizeBg();d.fx.combine([_1d._anim(_1d._img,_1d._coords(_1d._start,_1d._end)),_1d._anim(bg,{opacity:0.5})]).play();},_sizeBg:function(){var dd=d.doc.documentElement;d.style(this._bg,{top:0,left:0,width:dd.scrollWidth+"px",height:dd.scrollHeight+"px"});},_key:function(e){d.stopEvent(e);this._hide();},_coords:function(s,e){return {left:{start:s.x,end:e.x},top:{start:s.y,end:e.y},width:{start:s.w,end:e.w},height:{start:s.h,end:e.h}};},_hide:function(){var _2a=this;d.forEach(_2a._connects,d.disconnect);_2a._connects=[];d.fx.combine([_2a._anim(_2a._img,_2a._coords(_2a._end,_2a._start),"_reset"),_2a._anim(_2a._bg,{opacity:0})]).play();},_reset:function(){d.style(this._node,"visibility","visible");d.forEach([this._img,this._bg],function(n){d.destroy(n);n=null;});this._node.focus();},_anim:function(_2c,_2d,_2e){return d.animateProperty({node:_2c,duration:this.duration,properties:_2d,onEnd:_2e?d.hitch(this,_2e):null});}});})(_4);}}};});