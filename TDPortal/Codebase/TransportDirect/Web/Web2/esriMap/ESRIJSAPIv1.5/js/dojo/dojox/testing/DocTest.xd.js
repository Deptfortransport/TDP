/*
	Copyright (c) 2004-2009, The Dojo Foundation All Rights Reserved.
	Available via Academic Free License >= 2.1 OR the modified BSD license.
	see: http://dojotoolkit.org/license for details
*/


dojo._xdResourceLoaded(function(_1,_2,_3){return {depends:[["provide","dojox.testing.DocTest"],["require","dojo.string"]],defineResource:function(_4,_5,_6){if(!_4._hasResource["dojox.testing.DocTest"]){_4._hasResource["dojox.testing.DocTest"]=true;_4.provide("dojox.testing.DocTest");_4.require("dojo.string");_4.declare("dojox.testing.DocTest",null,{errors:[],getTests:function(_7){var _8=_4.moduleUrl(_7).path;var _9=_8.substring(0,_8.length-1)+".js";var _a=_4.xhrGet({url:_9,handleAs:"text"});var _b=_4._getText(_9);return this._getTestsFromString(_b,true);},getTestsFromString:function(_c){return this._getTestsFromString(_c,false);},_getTestsFromString:function(_d,_e){var _f=_4.hitch(_4.string,"trim");var _10=_d.split("\n");var len=_10.length;var _12=[];var _13={commands:[],expectedResult:[],line:null};for(var i=0;i<len+1;i++){var l=_f(_10[i]||"");if((_e&&l.match(/^\/\/\s+>>>\s.*/))||l.match(/^\s*>>>\s.*/)){if(!_13.line){_13.line=i+1;}if(_13.expectedResult.length>0){_12.push({commands:_13.commands,expectedResult:_13.expectedResult.join("\n"),line:_13.line});_13={commands:[],expectedResult:[],line:i+1};}l=_e?_f(l).substring(2,l.length):l;l=_f(l).substring(3,l.length);_13.commands.push(_f(l));}else{if((!_e||l.match(/^\/\/\s+.*/))&&_13.commands.length&&_13.expectedResult.length==0){l=_e?_f(l).substring(3,l.length):l;_13.expectedResult.push(_f(l));}else{if(_13.commands.length>0&&_13.expectedResult.length){if(!_e||l.match(/^\/\/\s*$/)){_12.push({commands:_13.commands,expectedResult:_13.expectedResult.join("\n"),line:_13.line});}if(_e&&!l.match(/^\/\//)){_12.push({commands:_13.commands,expectedResult:_13.expectedResult.join("\n"),line:_13.line});}_13={commands:[],expectedResult:[],line:0};}}}}return _12;},run:function(_16){this.errors=[];var _17=this.getTests(_16);if(_17){this._run(_17);}},_run:function(_18){var len=_18.length;this.tests=len;var oks=0;for(var i=0;i<len;i++){var t=_18[i];var res=this.runTest(t.commands,t.expectedResult);var msg="Test "+(i+1)+": ";var _1f=t.commands.join(" ");_1f=(_1f.length>50?_1f.substr(0,50)+"...":_1f);if(res.success){console.info(msg+"OK: "+_1f);oks+=1;}else{this.errors.push({commands:t.commands,actual:res.actualResult,expected:t.expectedResult});console.error(msg+"Failed: "+_1f,{commands:t.commands,actualResult:res.actualResult,expectedResult:t.expectedResult});}}console.info(len+" tests ran.",oks+" Success,",this.errors.length+" Errors");},runTest:function(_20,_21){var ret={success:false,actualResult:null};var _23=_20.join("\n");ret.actualResult=eval(_23);if((String(ret.actualResult)==_21)||(_4.toJson(ret.actualResult)==_21)||((_21.charAt(0)=="\"")&&(_21.charAt(_21.length-1)=="\"")&&(String(ret.actualResult)==_21.substring(1,_21.length-1)))){ret.success=true;}return ret;}});}}};});