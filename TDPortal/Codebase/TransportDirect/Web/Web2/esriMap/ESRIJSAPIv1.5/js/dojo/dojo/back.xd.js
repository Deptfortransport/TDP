/*
	Copyright (c) 2004-2009, The Dojo Foundation All Rights Reserved.
	Available via Academic Free License >= 2.1 OR the modified BSD license.
	see: http://dojotoolkit.org/license for details
*/


dojo._xdResourceLoaded(function(_1,_2,_3){return {depends:[["provide","dojo.back"]],defineResource:function(_4,_5,_6){if(!_4._hasResource["dojo.back"]){_4._hasResource["dojo.back"]=true;_4.provide("dojo.back");(function(){var _7=_4.back;function _8(){var h=window.location.hash;if(h.charAt(0)=="#"){h=h.substring(1);}return _4.isMozilla?h:decodeURIComponent(h);};function _a(h){if(!h){h="";}window.location.hash=encodeURIComponent(h);_c=history.length;};if(_4.exists("tests.back-hash")){_7.getHash=_8;_7.setHash=_a;}var _d=(typeof (window)!=="undefined")?window.location.href:"";var _e=(typeof (window)!=="undefined")?_8():"";var _f=null;var _10=null;var _11=null;var _12=null;var _13=[];var _14=[];var _15=false;var _16=false;var _c;function _17(){var _18=_14.pop();if(!_18){return;}var _19=_14[_14.length-1];if(!_19&&_14.length==0){_19=_f;}if(_19){if(_19.kwArgs["back"]){_19.kwArgs["back"]();}else{if(_19.kwArgs["backButton"]){_19.kwArgs["backButton"]();}else{if(_19.kwArgs["handle"]){_19.kwArgs.handle("back");}}}}_13.push(_18);};_7.goBack=_17;function _1a(){var _1b=_13.pop();if(!_1b){return;}if(_1b.kwArgs["forward"]){_1b.kwArgs.forward();}else{if(_1b.kwArgs["forwardButton"]){_1b.kwArgs.forwardButton();}else{if(_1b.kwArgs["handle"]){_1b.kwArgs.handle("forward");}}}_14.push(_1b);};_7.goForward=_1a;function _1c(url,_1e,_1f){return {"url":url,"kwArgs":_1e,"urlHash":_1f};};function _20(url){var _22=url.split("?");if(_22.length<2){return null;}else{return _22[1];}};function _23(){var url=(_4.config["dojoIframeHistoryUrl"]||_4.moduleUrl("dojo","resources/iframe_history.html"))+"?"+(new Date()).getTime();_15=true;if(_12){_4.isWebKit?_12.location=url:window.frames[_12.name].location=url;}else{}return url;};function _25(){if(!_16){var hsl=_14.length;var _27=_8();if((_27===_e||window.location.href==_d)&&(hsl==1)){_17();return;}if(_13.length>0){if(_13[_13.length-1].urlHash===_27){_1a();return;}}if((hsl>=2)&&(_14[hsl-2])){if(_14[hsl-2].urlHash===_27){_17();return;}}if(_4.isSafari&&_4.isSafari<3){var _28=history.length;if(_28>_c){_1a();}else{if(_28<_c){_17();}}_c=_28;}}};_7.init=function(){if(_4.byId("dj_history")){return;}var src=_4.config["dojoIframeHistoryUrl"]||_4.moduleUrl("dojo","resources/iframe_history.html");document.write("<iframe style=\"border:0;width:1px;height:1px;position:absolute;visibility:hidden;bottom:0;right:0;\" name=\"dj_history\" id=\"dj_history\" src=\""+src+"\"></iframe>");};_7.setInitialState=function(_2a){_f=_1c(_d,_2a,_e);};_7.addToHistory=function(_2b){_13=[];var _2c=null;var url=null;if(!_12){if(_4.config["useXDomain"]&&!_4.config["dojoIframeHistoryUrl"]){console.warn("dojo.back: When using cross-domain Dojo builds,"+" please save iframe_history.html to your domain and set djConfig.dojoIframeHistoryUrl"+" to the path on your domain to iframe_history.html");}_12=window.frames["dj_history"];}if(!_11){_11=_4.create("a",{style:{display:"none"}},_4.body());}if(_2b["changeUrl"]){_2c=""+((_2b["changeUrl"]!==true)?_2b["changeUrl"]:(new Date()).getTime());if(_14.length==0&&_f.urlHash==_2c){_f=_1c(url,_2b,_2c);return;}else{if(_14.length>0&&_14[_14.length-1].urlHash==_2c){_14[_14.length-1]=_1c(url,_2b,_2c);return;}}_16=true;setTimeout(function(){_a(_2c);_16=false;},1);_11.href=_2c;if(_4.isIE){url=_23();var _2e=_2b["back"]||_2b["backButton"]||_2b["handle"];var tcb=function(_30){if(_8()!=""){setTimeout(function(){_a(_2c);},1);}_2e.apply(this,[_30]);};if(_2b["back"]){_2b.back=tcb;}else{if(_2b["backButton"]){_2b.backButton=tcb;}else{if(_2b["handle"]){_2b.handle=tcb;}}}var _31=_2b["forward"]||_2b["forwardButton"]||_2b["handle"];var tfw=function(_33){if(_8()!=""){_a(_2c);}if(_31){_31.apply(this,[_33]);}};if(_2b["forward"]){_2b.forward=tfw;}else{if(_2b["forwardButton"]){_2b.forwardButton=tfw;}else{if(_2b["handle"]){_2b.handle=tfw;}}}}else{if(!_4.isIE){if(!_10){_10=setInterval(_25,200);}}}}else{url=_23();}_14.push(_1c(url,_2b,_2c));};_7._iframeLoaded=function(evt,_35){var _36=_20(_35.href);if(_36==null){if(_14.length==1){_17();}return;}if(_15){_15=false;return;}if(_14.length>=2&&_36==_20(_14[_14.length-2].url)){_17();}else{if(_13.length>0&&_36==_20(_13[_13.length-1].url)){_1a();}}};})();}}};});