/*
	Copyright (c) 2004-2009, The Dojo Foundation All Rights Reserved.
	Available via Academic Free License >= 2.1 OR the modified BSD license.
	see: http://dojotoolkit.org/license for details
*/


dojo._xdResourceLoaded(function(_1,_2,_3){return {depends:[["provide","dojo.dnd.Container"],["require","dojo.dnd.common"],["require","dojo.parser"]],defineResource:function(_4,_5,_6){if(!_4._hasResource["dojo.dnd.Container"]){_4._hasResource["dojo.dnd.Container"]=true;_4.provide("dojo.dnd.Container");_4.require("dojo.dnd.common");_4.require("dojo.parser");_4.declare("dojo.dnd.Container",null,{skipForm:false,constructor:function(_7,_8){this.node=_4.byId(_7);if(!_8){_8={};}this.creator=_8.creator||null;this.skipForm=_8.skipForm;this.parent=_8.dropParent&&_4.byId(_8.dropParent);this.map={};this.current=null;this.containerState="";_4.addClass(this.node,"dojoDndContainer");if(!(_8&&_8._skipStartup)){this.startup();}this.events=[_4.connect(this.node,"onmouseover",this,"onMouseOver"),_4.connect(this.node,"onmouseout",this,"onMouseOut"),_4.connect(this.node,"ondragstart",this,"onSelectStart"),_4.connect(this.node,"onselectstart",this,"onSelectStart")];},creator:function(){},getItem:function(_9){return this.map[_9];},setItem:function(_a,_b){this.map[_a]=_b;},delItem:function(_c){delete this.map[_c];},forInItems:function(f,o){o=o||_4.global;var m=this.map,e=_4.dnd._empty;for(var i in m){if(i in e){continue;}f.call(o,m[i],i,this);}return o;},clearItems:function(){this.map={};},getAllNodes:function(){return _4.query("> .dojoDndItem",this.parent);},sync:function(){var map={};this.getAllNodes().forEach(function(_13){if(_13.id){var _14=this.getItem(_13.id);if(_14){map[_13.id]=_14;return;}}else{_13.id=_4.dnd.getUniqueId();}var _15=_13.getAttribute("dndType"),_16=_13.getAttribute("dndData");map[_13.id]={data:_16||_13.innerHTML,type:_15?_15.split(/\s*,\s*/):["text"]};},this);this.map=map;return this;},insertNodes:function(_17,_18,_19){if(!this.parent.firstChild){_19=null;}else{if(_18){if(!_19){_19=this.parent.firstChild;}}else{if(_19){_19=_19.nextSibling;}}}if(_19){for(var i=0;i<_17.length;++i){var t=this._normalizedCreator(_17[i]);this.setItem(t.node.id,{data:t.data,type:t.type});this.parent.insertBefore(t.node,_19);}}else{for(var i=0;i<_17.length;++i){var t=this._normalizedCreator(_17[i]);this.setItem(t.node.id,{data:t.data,type:t.type});this.parent.appendChild(t.node);}}return this;},destroy:function(){_4.forEach(this.events,_4.disconnect);this.clearItems();this.node=this.parent=this.current=null;},markupFactory:function(_1c,_1d){_1c._skipStartup=true;return new _4.dnd.Container(_1d,_1c);},startup:function(){if(!this.parent){this.parent=this.node;if(this.parent.tagName.toLowerCase()=="table"){var c=this.parent.getElementsByTagName("tbody");if(c&&c.length){this.parent=c[0];}}}this.defaultCreator=_4.dnd._defaultCreator(this.parent);this.sync();},onMouseOver:function(e){var n=e.relatedTarget;while(n){if(n==this.node){break;}try{n=n.parentNode;}catch(x){n=null;}}if(!n){this._changeState("Container","Over");this.onOverEvent();}n=this._getChildByEvent(e);if(this.current==n){return;}if(this.current){this._removeItemClass(this.current,"Over");}if(n){this._addItemClass(n,"Over");}this.current=n;},onMouseOut:function(e){for(var n=e.relatedTarget;n;){if(n==this.node){return;}try{n=n.parentNode;}catch(x){n=null;}}if(this.current){this._removeItemClass(this.current,"Over");this.current=null;}this._changeState("Container","");this.onOutEvent();},onSelectStart:function(e){if(!this.skipForm||!_4.dnd.isFormElement(e)){_4.stopEvent(e);}},onOverEvent:function(){},onOutEvent:function(){},_changeState:function(_24,_25){var _26="dojoDnd"+_24;var _27=_24.toLowerCase()+"State";_4.removeClass(this.node,_26+this[_27]);_4.addClass(this.node,_26+_25);this[_27]=_25;},_addItemClass:function(_28,_29){_4.addClass(_28,"dojoDndItem"+_29);},_removeItemClass:function(_2a,_2b){_4.removeClass(_2a,"dojoDndItem"+_2b);},_getChildByEvent:function(e){var _2d=e.target;if(_2d){for(var _2e=_2d.parentNode;_2e;_2d=_2e,_2e=_2d.parentNode){if(_2e==this.parent&&_4.hasClass(_2d,"dojoDndItem")){return _2d;}}}return null;},_normalizedCreator:function(_2f,_30){var t=(this.creator||this.defaultCreator).call(this,_2f,_30);if(!_4.isArray(t.type)){t.type=["text"];}if(!t.node.id){t.node.id=_4.dnd.getUniqueId();}_4.addClass(t.node,"dojoDndItem");return t;}});_4.dnd._createNode=function(tag){if(!tag){return _4.dnd._createSpan;}return function(_33){return _4.create(tag,{innerHTML:_33});};};_4.dnd._createTrTd=function(_34){var tr=_4.create("tr");_4.create("td",{innerHTML:_34},tr);return tr;};_4.dnd._createSpan=function(_36){return _4.create("span",{innerHTML:_36});};_4.dnd._defaultCreatorNodes={ul:"li",ol:"li",div:"div",p:"div"};_4.dnd._defaultCreator=function(_37){var tag=_37.tagName.toLowerCase();var c=tag=="tbody"||tag=="thead"?_4.dnd._createTrTd:_4.dnd._createNode(_4.dnd._defaultCreatorNodes[tag]);return function(_3a,_3b){var _3c=_3a&&_4.isObject(_3a),_3d,_3e,n;if(_3c&&_3a.tagName&&_3a.nodeType&&_3a.getAttribute){_3d=_3a.getAttribute("dndData")||_3a.innerHTML;_3e=_3a.getAttribute("dndType");_3e=_3e?_3e.split(/\s*,\s*/):["text"];n=_3a;}else{_3d=(_3c&&_3a.data)?_3a.data:_3a;_3e=(_3c&&_3a.type)?_3a.type:["text"];n=(_3b=="avatar"?_4.dnd._createSpan:c)(String(_3d));}n.id=_4.dnd.getUniqueId();return {node:n,data:_3d,type:_3e};};};}}};});