/*
	Copyright (c) 2004-2009, The Dojo Foundation All Rights Reserved.
	Available via Academic Free License >= 2.1 OR the modified BSD license.
	see: http://dojotoolkit.org/license for details
*/


dojo._xdResourceLoaded(function(_1,_2,_3){return {depends:[["provide","dijit._editor.selection"]],defineResource:function(_4,_5,_6){if(!_4._hasResource["dijit._editor.selection"]){_4._hasResource["dijit._editor.selection"]=true;_4.provide("dijit._editor.selection");_4.mixin(_5._editor.selection,{getType:function(){if(_4.doc.selection){return _4.doc.selection.type.toLowerCase();}else{var _7="text";var _8;try{_8=_4.global.getSelection();}catch(e){}if(_8&&_8.rangeCount==1){var _9=_8.getRangeAt(0);if((_9.startContainer==_9.endContainer)&&((_9.endOffset-_9.startOffset)==1)&&(_9.startContainer.nodeType!=3)){_7="control";}}return _7;}},getSelectedText:function(){if(_4.doc.selection){if(_5._editor.selection.getType()=="control"){return null;}return _4.doc.selection.createRange().text;}else{var _a=_4.global.getSelection();if(_a){return _a.toString();}}return "";},getSelectedHtml:function(){if(_4.doc.selection){if(_5._editor.selection.getType()=="control"){return null;}return _4.doc.selection.createRange().htmlText;}else{var _b=_4.global.getSelection();if(_b&&_b.rangeCount){var _c=_b.getRangeAt(0).cloneContents();var _d=_4.doc.createElement("div");_d.appendChild(_c);return _d.innerHTML;}return null;}},getSelectedElement:function(){if(_5._editor.selection.getType()=="control"){if(_4.doc.selection){var _e=_4.doc.selection.createRange();if(_e&&_e.item){return _4.doc.selection.createRange().item(0);}}else{var _f=_4.global.getSelection();return _f.anchorNode.childNodes[_f.anchorOffset];}}return null;},getParentElement:function(){if(_5._editor.selection.getType()=="control"){var p=this.getSelectedElement();if(p){return p.parentNode;}}else{if(_4.doc.selection){var r=_4.doc.selection.createRange();r.collapse(true);return r.parentElement();}else{var _12=_4.global.getSelection();if(_12){var _13=_12.anchorNode;while(_13&&(_13.nodeType!=1)){_13=_13.parentNode;}return _13;}}}return null;},hasAncestorElement:function(_14){return this.getAncestorElement.apply(this,arguments)!=null;},getAncestorElement:function(_15){var _16=this.getSelectedElement()||this.getParentElement();return this.getParentOfType(_16,arguments);},isTag:function(_17,_18){if(_17&&_17.tagName){var _19=_17.tagName.toLowerCase();for(var i=0;i<_18.length;i++){var _1b=String(_18[i]).toLowerCase();if(_19==_1b){return _1b;}}}return "";},getParentOfType:function(_1c,_1d){while(_1c){if(this.isTag(_1c,_1d).length){return _1c;}_1c=_1c.parentNode;}return null;},collapse:function(_1e){if(window["getSelection"]){var _1f=_4.global.getSelection();if(_1f.removeAllRanges){if(_1e){_1f.collapseToStart();}else{_1f.collapseToEnd();}}else{_1f.collapse(_1e);}}else{if(_4.doc.selection){var _20=_4.doc.selection.createRange();_20.collapse(_1e);_20.select();}}},remove:function(){var _s=_4.doc.selection;if(_s){if(_s.type.toLowerCase()!="none"){_s.clear();}return _s;}else{_s=_4.global.getSelection();_s.deleteFromDocument();return _s;}},selectElementChildren:function(_22,_23){var _24=_4.global;var _25=_4.doc;_22=_4.byId(_22);if(_25.selection&&_4.body().createTextRange){var _26=_22.ownerDocument.body.createTextRange();_26.moveToElementText(_22);if(!_23){try{_26.select();}catch(e){}}}else{if(_24.getSelection){var _27=_24.getSelection();if(_27.setBaseAndExtent){_27.setBaseAndExtent(_22,0,_22,_22.innerText.length-1);}else{if(_27.selectAllChildren){_27.selectAllChildren(_22);}}}}},selectElement:function(_28,_29){var _2a,_2b=_4.doc;_28=_4.byId(_28);if(_2b.selection&&_4.body().createTextRange){try{_2a=_4.body().createControlRange();_2a.addElement(_28);if(!_29){_2a.select();}}catch(e){this.selectElementChildren(_28,_29);}}else{if(_4.global.getSelection){var _2c=_4.global.getSelection();if(_2c.removeAllRanges){_2a=_2b.createRange();_2a.selectNode(_28);_2c.removeAllRanges();_2c.addRange(_2a);}}}}});}}};});