/*
	Copyright (c) 2004-2009, The Dojo Foundation All Rights Reserved.
	Available via Academic Free License >= 2.1 OR the modified BSD license.
	see: http://dojotoolkit.org/license for details
*/


dojo._xdResourceLoaded(function(_1,_2,_3){return {depends:[["provide","dojox.form._HasDropDown"],["require","dijit._Widget"]],defineResource:function(_4,_5,_6){if(!_4._hasResource["dojox.form._HasDropDown"]){_4._hasResource["dojox.form._HasDropDown"]=true;_4.provide("dojox.form._HasDropDown");_4.require("dijit._Widget");_4.declare("dojox.form._HasDropDown",null,{dropDownNode:null,popupStateNode:null,aroundNode:null,dropDown:null,autoWidth:true,_stopClickEvents:true,_onMenuMouseup:function(e){},_onDropDownMouse:function(e){if(e.type=="click"&&!this._seenKeydown){return;}this._seenKeydown=false;if(e.type=="mousedown"){this._docHandler=this.connect(_4.doc,"onmouseup","_onDropDownMouseup");}if(this.disabled||this.readOnly){return;}if(this._stopClickEvents){_4.stopEvent(e);}this.toggleDropDown();if(e.type=="click"||e.type=="keypress"){this._onDropDownMouseup();}},_onDropDownMouseup:function(e){if(e&&this._docHandler){this.disconnect(this._docHandler);}var _a=this.dropDown,_b=false;if(e&&this._opened){var t=e.target;while(t&&!_b){if(_4.hasClass(t,"dijitPopup")){_b=true;}else{t=t.parentNode;}}if(_b){this._onMenuMouseup(e);return;}}if(this._opened&&_a.focus){window.setTimeout(_4.hitch(_a,"focus"),1);}else{_5.focus(this.focusNode);}},_setupDropdown:function(){this.dropDownNode=this.dropDownNode||this.focusNode||this.domNode;this.popupStateNode=this.popupStateNode||this.focusNode||this.dropDownNode;this.aroundNode=this.aroundNode||this.domNode;this.connect(this.dropDownNode,"onmousedown","_onDropDownMouse");this.connect(this.dropDownNode,"onclick","_onDropDownMouse");this.connect(this.dropDownNode,"onkeydown","_onDropDownKeydown");this.connect(this.dropDownNode,"onblur","_onDropDownBlur");this.connect(this.dropDownNode,"onkeypress","_onKey");if(this._setStateClass){this.connect(this,"openDropDown","_setStateClass");this.connect(this,"closeDropDown","_setStateClass");}},postCreate:function(){this._setupDropdown();this.inherited("postCreate",arguments);},startup:function(){_5.popup.prepare(this.dropDown.domNode);this.inherited("startup",arguments);},destroyDescendants:function(){if(this.dropDown){this.dropDown.destroyRecursive();delete this.dropDown;}this.inherited("destroyDescendants",arguments);},_onDropDownKeydown:function(e){this._seenKeydown=true;},_onKeyPress:function(e){if(this._opened&&e.charOrCode==_4.keys.ESCAPE&&!e.shiftKey&&!e.ctrlKey&&!e.altKey){this.toggleDropDown();_4.stopEvent(e);return;}this.inherited(arguments);},_onDropDownBlur:function(e){this._seenKeydown=false;},_onKey:function(e){if(this.disabled||this.readOnly){return;}var d=this.dropDown;if(d&&this._opened&&d.handleKey){if(d.handleKey(e)===false){return;}}if(d&&this._opened&&e.keyCode==_4.keys.ESCAPE){this.toggleDropDown();return;}if(e.keyCode==_4.keys.DOWN_ARROW){this._onDropDownMouse(e);}},_onBlur:function(){this.closeDropDown();this.inherited("_onBlur",arguments);},isLoaded:function(){return true;},loadDropDown:function(_12){_12();},toggleDropDown:function(){if(this.disabled||this.readOnly){return;}this.focus();var _13=this.dropDown;if(!_13){return;}if(!this._opened){if(!this.isLoaded()){this.loadDropDown(_4.hitch(this,"openDropDown"));return;}else{this.openDropDown();}}else{this.closeDropDown();}},openDropDown:function(){var _14=this.dropDown;var _15=_14.domNode.style.width;var _16=this;var _17=_5.popup.open({parent:this,popup:_14,around:this.aroundNode,orient:this.isLeftToRight()?{"BL":"TL","BR":"TR","TL":"BL","TR":"BR"}:{"BR":"TR","BL":"TL","TR":"BR","TL":"BL"},onExecute:function(){_16.closeDropDown(true);},onCancel:function(){_16.closeDropDown(true);},onClose:function(){_14.domNode.style.width=_15;_4.attr(_16.popupStateNode,"popupActive",false);_4.removeClass(_16.popupStateNode,"dojoxHasDropDownOpen");_16._opened=false;_16.state="";}});if(this.autoWidth&&this.domNode.offsetWidth>_14.domNode.offsetWidth){var _18=null;if(!this.isLeftToRight()){_18=_14.domNode.parentNode;var _19=_18.offsetLeft+_18.offsetWidth;}if(_14.resize){_14.resize({w:this.domNode.offsetWidth});}else{_4.marginBox(_14.domNode,{w:this.domNode.offsetWidth});}if(_18){_18.style.left=_19-this.domNode.offsetWidth+"px";}}_4.attr(this.popupStateNode,"popupActive","true");_4.addClass(_16.popupStateNode,"dojoxHasDropDownOpen");this._opened=true;this.state="Opened";return _17;},closeDropDown:function(_1a){if(this._opened){_5.popup.close(this.dropDown);if(_1a){this.focus();}this._opened=false;this.state="";}}});}}};});