/*
	Copyright (c) 2004-2009, The Dojo Foundation All Rights Reserved.
	Available via Academic Free License >= 2.1 OR the modified BSD license.
	see: http://dojotoolkit.org/license for details
*/


dojo._xdResourceLoaded(function(_1,_2,_3){return {depends:[["provide","dijit._editor.RichText"],["require","dijit._Widget"],["require","dijit._editor.selection"],["require","dijit._editor.range"],["require","dijit._editor.html"],["require","dojo.i18n"],["requireLocalization","dijit.form","Textarea",null,"ROOT,ar,ca,cs,da,de,el,es,fi,fr,he,hu,it,ja,ko,nb,nl,pl,pt,pt-pt,ru,sk,sl,sv,th,tr,zh,zh-tw","ROOT,ar,ca,cs,da,de,el,es,fi,fr,he,hu,it,ja,ko,nb,nl,pl,pt,pt-pt,ru,sk,sl,sv,th,tr,zh,zh-tw"]],defineResource:function(_4,_5,_6){if(!_4._hasResource["dijit._editor.RichText"]){_4._hasResource["dijit._editor.RichText"]=true;_4.provide("dijit._editor.RichText");_4.require("dijit._Widget");_4.require("dijit._editor.selection");_4.require("dijit._editor.range");_4.require("dijit._editor.html");_4.require("dojo.i18n");if(!_4.config["useXDomain"]||_4.config["allowXdRichTextSave"]){if(_4._postLoad){(function(){var _7=_4.doc.createElement("textarea");_7.id=_5._scopeName+"._editor.RichText.savedContent";_4.style(_7,{display:"none",position:"absolute",top:"-100px",height:"3px",width:"3px"});_4.body().appendChild(_7);})();}else{try{_4.doc.write("<textarea id=\""+_5._scopeName+"._editor.RichText.savedContent\" "+"style=\"display:none;position:absolute;top:-100px;left:-100px;height:3px;width:3px;overflow:hidden;\"></textarea>");}catch(e){}}}_4.declare("dijit._editor.RichText",_5._Widget,{constructor:function(_8){this.contentPreFilters=[];this.contentPostFilters=[];this.contentDomPreFilters=[];this.contentDomPostFilters=[];this.editingAreaStyleSheets=[];this._keyHandlers={};this.contentPreFilters.push(_4.hitch(this,"_preFixUrlAttributes"));if(_4.isMoz){this.contentPreFilters.push(this._fixContentForMoz);this.contentPostFilters.push(this._removeMozBogus);}if(_4.isSafari){this.contentPostFilters.push(this._removeSafariBogus);}this.onLoadDeferred=new _4.Deferred();},inheritWidth:false,focusOnLoad:false,name:"",styleSheets:"",_content:"",height:"300px",minHeight:"1em",isClosed:true,isLoaded:false,_SEPARATOR:"@@**%%__RICHTEXTBOUNDRY__%%**@@",onLoadDeferred:null,isTabIndent:false,disableSpellCheck:false,postCreate:function(){if("textarea"==this.domNode.tagName.toLowerCase()){console.warn("RichText should not be used with the TEXTAREA tag.  See dijit._editor.RichText docs.");}_4.publish(_5._scopeName+"._editor.RichText::init",[this]);this.open();this.setupDefaultShortcuts();},setupDefaultShortcuts:function(){var _9=_4.hitch(this,function(_a,_b){return function(){return !this.execCommand(_a,_b);};});var _c={b:_9("bold"),i:_9("italic"),u:_9("underline"),a:_9("selectall"),s:function(){this.save(true);},m:function(){this.isTabIndent=!this.isTabIndent;},"1":_9("formatblock","h1"),"2":_9("formatblock","h2"),"3":_9("formatblock","h3"),"4":_9("formatblock","h4"),"\\":_9("insertunorderedlist")};if(!_4.isIE){_c.Z=_9("redo");}for(var _d in _c){this.addKeyHandler(_d,true,false,_c[_d]);}},events:["onKeyPress","onKeyDown","onKeyUp","onClick"],captureEvents:[],_editorCommandsLocalized:false,_localizeEditorCommands:function(){if(this._editorCommandsLocalized){return;}this._editorCommandsLocalized=true;var _e=["div","p","pre","h1","h2","h3","h4","h5","h6","ol","ul","address"];var _f="",_10,i=0;while((_10=_e[i++])){if(_10.charAt(1)!="l"){_f+="<"+_10+"><span>content</span></"+_10+"><br/>";}else{_f+="<"+_10+"><li>content</li></"+_10+"><br/>";}}var div=_4.doc.createElement("div");_4.style(div,{position:"absolute",top:"-2000px"});_4.doc.body.appendChild(div);div.innerHTML=_f;var _13=div.firstChild;while(_13){_5._editor.selection.selectElement(_13.firstChild);_4.withGlobal(this.window,"selectElement",_5._editor.selection,[_13.firstChild]);var _14=_13.tagName.toLowerCase();this._local2NativeFormatNames[_14]=document.queryCommandValue("formatblock");this._native2LocalFormatNames[this._local2NativeFormatNames[_14]]=_14;_13=_13.nextSibling.nextSibling;}_4.body().removeChild(div);},open:function(_15){if(!this.onLoadDeferred||this.onLoadDeferred.fired>=0){this.onLoadDeferred=new _4.Deferred();}if(!this.isClosed){this.close();}_4.publish(_5._scopeName+"._editor.RichText::open",[this]);this._content="";if(arguments.length==1&&_15.nodeName){this.domNode=_15;}var dn=this.domNode;var _17;if(dn.nodeName&&dn.nodeName.toLowerCase()=="textarea"){var ta=(this.textarea=dn);this.name=ta.name;_17=this._preFilterContent(ta.value);dn=this.domNode=_4.doc.createElement("div");dn.setAttribute("widgetId",this.id);ta.removeAttribute("widgetId");dn.cssText=ta.cssText;dn.className+=" "+ta.className;_4.place(dn,ta,"before");var _19=_4.hitch(this,function(){_4.style(ta,{display:"block",position:"absolute",top:"-1000px"});if(_4.isIE){var s=ta.style;this.__overflow=s.overflow;s.overflow="hidden";}});if(_4.isIE){setTimeout(_19,10);}else{_19();}if(ta.form){_4.connect(ta.form,"onsubmit",this,function(){ta.value=this.getValue();});}}else{_17=this._preFilterContent(_5._editor.getChildrenHtml(dn));dn.innerHTML="";}var _1b=_4.contentBox(dn);this._oldHeight=_1b.h;this._oldWidth=_1b.w;this.savedContent=_17;if(dn.nodeName&&dn.nodeName=="LI"){dn.innerHTML=" <br>";}this.editingArea=dn.ownerDocument.createElement("div");dn.appendChild(this.editingArea);if(this.name!=""&&(!_4.config["useXDomain"]||_4.config["allowXdRichTextSave"])){var _1c=_4.byId(_5._scopeName+"._editor.RichText.savedContent");if(_1c.value!=""){var _1d=_1c.value.split(this._SEPARATOR),i=0,dat;while((dat=_1d[i++])){var _20=dat.split(":");if(_20[0]==this.name){_17=_20[1];_1d.splice(i,1);break;}}}this.connect(window,"onbeforeunload","_saveContent");}this.isClosed=false;if(_4.isIE||_4.isWebKit||_4.isOpera){var ifr=(this.editorObject=this.iframe=_4.doc.createElement("iframe"));ifr.id=this.id+"_iframe";this._iframeSrc=this._getIframeDocTxt(_17);ifr.style.border="none";ifr.style.width="100%";if(this._layoutMode){ifr.style.height="100%";}else{if(_4.isIE>=7){if(this.height){ifr.style.height=this.height;}if(this.minHeight){ifr.style.minHeight=this.minHeight;}}else{ifr.style.height=this.height?this.height:this.minHeight;}}ifr.frameBorder=0;ifr._loadFunc=_4.hitch(this,function(win){this.window=win;this.document=this.window.document;if(_4.isIE){this._localizeEditorCommands();}this.onLoad();this.savedContent=this.getValue(true);});var s="javascript:parent."+_5._scopeName+".byId(\""+this.id+"\")._iframeSrc";ifr.setAttribute("src",s);this.editingArea.appendChild(ifr);if(_4.isWebKit){setTimeout(function(){ifr.setAttribute("src",s);},0);}}else{this._drawIframe(_17);this.savedContent=this.getValue(true);}if(dn.nodeName=="LI"){dn.lastChild.style.marginTop="-1.2em";}if(this.domNode.nodeName=="LI"){this.domNode.lastChild.style.marginTop="-1.2em";}_4.addClass(this.domNode,"RichTextEditable");},_local2NativeFormatNames:{},_native2LocalFormatNames:{},_localizedIframeTitles:null,_getIframeDocTxt:function(_24){var _cs=_4.getComputedStyle(this.domNode);if(_4.isIE||(!this.height&&!_4.isMoz)){_24="<div>"+_24+"</div>";}var _26=[_cs.fontWeight,_cs.fontSize,_cs.fontFamily].join(" ");var _27=_cs.lineHeight;if(_27.indexOf("px")>=0){_27=parseFloat(_27)/parseFloat(_cs.fontSize);}else{if(_27.indexOf("em")>=0){_27=parseFloat(_27);}else{_27="1.0";}}var _28="";this.style.replace(/(^|;)(line-|font-?)[^;]+/g,function(_29){_28+=_29.replace(/^;/g,"")+";";});var d=_4.doc;var _2b=d.charset||d.characterSet||d.defaultCharset||"UTF-8";return [this.isLeftToRight()?"<html><head>":"<html dir='rtl'><head>",(_4.isMoz?"<title>"+this._localizedIframeTitles.iframeEditTitle+"</title>":""),"<meta http-equiv='Content-Type' content='text/html; charset="+_2b+"'>","<style>","body,html {","\tbackground:transparent;","\tpadding: 1em 0 0 0;","\tmargin: -1em 0 0 0;","}","body{","\ttop:0px; left:0px; right:0px;","\tfont:",_26,";",((this.height||_4.isOpera)?"":"position: fixed;"),"\tmin-height:",this.minHeight,";","\tline-height:",_27,"}","p{ margin: 1em 0 !important; }",(this.height?"":"body,html{overflow-y:hidden;/*for IE*/} body > div {overflow-x:auto;/*FF:horizontal scrollbar*/ overflow-y:hidden;/*safari*/ min-height:"+this.minHeight+";/*safari*/}"),"li > ul:-moz-first-node, li > ol:-moz-first-node{ padding-top: 1.2em; } ","li{ min-height:1.2em; }","</style>",this._applyEditingAreaStyleSheets(),"</head><body onload='frameElement._loadFunc(window,document)' style='"+_28+"'>"+_24+"</body></html>"].join("");},_drawIframe:function(_2c){if(!this.iframe){var ifr=(this.iframe=_4.doc.createElement("iframe"));ifr.id=this.id+"_iframe";var _2e=ifr.style;_2e.border="none";_2e.lineHeight="0";_2e.verticalAlign="bottom";this.editorObject=this.iframe;this._localizedIframeTitles=_4.i18n.getLocalization("dijit.form","Textarea");var _2f=_4.query("label[for=\""+this.id+"\"]");if(_2f.length){this._localizedIframeTitles.iframeEditTitle=_2f[0].innerHTML+" "+this._localizedIframeTitles.iframeEditTitle;}ifr._loadFunc=function(win){};}this.iframe.style.width=this.inheritWidth?this._oldWidth:"100%";if(this._layoutMode){this.iframe.style.height="100%";}else{if(this.height){this.iframe.style.height=this.height;}else{this.iframe.height=this._oldHeight;}}var _31;if(this.textarea){_31=this.srcNodeRef;}else{_31=_4.doc.createElement("div");_31.style.display="none";_31.innerHTML=_2c;this.editingArea.appendChild(_31);}this.editingArea.appendChild(this.iframe);var _32=_4.hitch(this,function(){if(!this.editNode){if(!this.document){try{if(this.iframe.contentWindow){this.window=this.iframe.contentWindow;this.document=this.iframe.contentWindow.document;}else{if(this.iframe.contentDocument){this.window=this.iframe.contentDocument.window;this.document=this.iframe.contentDocument;}}}catch(e){}if(!this.document){setTimeout(_32,50);return;}var _33=this.document;_33.open();if(_4.isAIR){_33.body.innerHTML=_2c;}else{_33.write(this._getIframeDocTxt(_2c));}_33.close();_4.destroy(_31);}if(!this.document.body){setTimeout(_32,50);return;}this.onLoad();}else{_4.destroy(_31);this.editNode.innerHTML=_2c;this.onDisplayChanged();}this._preDomFilterContent(this.editNode);});_32();},_applyEditingAreaStyleSheets:function(){var _34=[];if(this.styleSheets){_34=this.styleSheets.split(";");this.styleSheets="";}_34=_34.concat(this.editingAreaStyleSheets);this.editingAreaStyleSheets=[];var _35="",i=0,url;while((url=_34[i++])){var _38=(new _4._Url(_4.global.location,url)).toString();this.editingAreaStyleSheets.push(_38);_35+="<link rel=\"stylesheet\" type=\"text/css\" href=\""+_38+"\"/>";}return _35;},addStyleSheet:function(uri){var url=uri.toString();if(url.charAt(0)=="."||(url.charAt(0)!="/"&&!uri.host)){url=(new _4._Url(_4.global.location,url)).toString();}if(_4.indexOf(this.editingAreaStyleSheets,url)>-1){return;}this.editingAreaStyleSheets.push(url);if(this.document.createStyleSheet){this.document.createStyleSheet(url);}else{var _3b=this.document.getElementsByTagName("head")[0];var _3c=this.document.createElement("link");_3c.rel="stylesheet";_3c.type="text/css";_3c.href=url;_3b.appendChild(_3c);}},removeStyleSheet:function(uri){var url=uri.toString();if(url.charAt(0)=="."||(url.charAt(0)!="/"&&!uri.host)){url=(new _4._Url(_4.global.location,url)).toString();}var _3f=_4.indexOf(this.editingAreaStyleSheets,url);if(_3f==-1){return;}delete this.editingAreaStyleSheets[_3f];_4.withGlobal(this.window,"query",_4,["link:[href=\""+url+"\"]"]).orphan();},disabled:false,_mozSettingProps:{"styleWithCSS":false},_setDisabledAttr:function(_40){this.disabled=_40;if(!this.isLoaded){return;}_40=!!_40;if(_4.isIE||_4.isWebKit||_4.isOpera){var _41=_4.isIE&&(this.isLoaded||!this.focusOnLoad);if(_41){this.editNode.unselectable="on";}this.editNode.contentEditable=!_40;if(_41){var _42=this;setTimeout(function(){_42.editNode.unselectable="off";},0);}}else{try{this.document.designMode=(_40?"off":"on");}catch(e){return;}if(!_40&&this._mozSettingProps){var ps=this._mozSettingProps;for(var n in ps){if(ps.hasOwnProperty(n)){try{this.document.execCommand(n,false,ps[n]);}catch(e){}}}}}this._disabledOK=true;},_isResized:function(){return false;},onLoad:function(e){if(!this.window.__registeredWindow){this.window.__registeredWindow=true;_5.registerIframe(this.iframe);}if(!_4.isIE&&(this.height||_4.isMoz)){this.editNode=this.document.body;}else{this.editNode=this.document.body.firstChild;var _46=this;if(_4.isIE){var _47=(this.tabStop=_4.doc.createElement("<div tabIndex=-1>"));this.editingArea.appendChild(_47);this.iframe.onfocus=function(){_46.editNode.setActive();};}}this.focusNode=this.editNode;this._preDomFilterContent(this.editNode);var _48=this.events.concat(this.captureEvents);var ap=this.iframe?this.document:this.editNode;_4.forEach(_48,function(_4a){this.connect(ap,_4a.toLowerCase(),_4a);},this);if(_4.isIE){this.connect(this.document,"onmousedown","_onIEMouseDown");this.editNode.style.zoom=1;}if(_4.isWebKit){this._webkitListener=this.connect(this.document,"onmouseup","onDisplayChanged");}this.isLoaded=true;this.attr("disabled",this.disabled);if(this.onLoadDeferred){this.onLoadDeferred.callback(true);}this.onDisplayChanged(e);if(this.focusOnLoad){_4.addOnLoad(_4.hitch(this,function(){setTimeout(_4.hitch(this,"focus"),this.updateInterval);}));}},onKeyDown:function(e){if(e.keyCode===_4.keys.TAB&&this.isTabIndent){_4.stopEvent(e);if(this.queryCommandEnabled((e.shiftKey?"outdent":"indent"))){this.execCommand((e.shiftKey?"outdent":"indent"));}}if(_4.isIE){if(e.keyCode==_4.keys.TAB&&!this.isTabIndent){if(e.shiftKey&&!e.ctrlKey&&!e.altKey){this.iframe.focus();}else{if(!e.shiftKey&&!e.ctrlKey&&!e.altKey){this.tabStop.focus();}}}else{if(e.keyCode===_4.keys.BACKSPACE&&this.document.selection.type==="Control"){_4.stopEvent(e);this.execCommand("delete");}else{if((65<=e.keyCode&&e.keyCode<=90)||(e.keyCode>=37&&e.keyCode<=40)){e.charCode=e.keyCode;this.onKeyPress(e);}}}}else{if(_4.isMoz&&!this.isTabIndent){if(e.keyCode==_4.keys.TAB&&!e.shiftKey&&!e.ctrlKey&&!e.altKey&&this.iframe){var _4c=_4.isFF<3?this.iframe.contentDocument:this.iframe;_4c.title=this._localizedIframeTitles.iframeFocusTitle;this.iframe.focus();_4.stopEvent(e);}else{if(e.keyCode==_4.keys.TAB&&e.shiftKey){if(this.toolbar){this.toolbar.focus();}_4.stopEvent(e);}}}}return true;},onKeyUp:function(e){return;},setDisabled:function(_4e){_4.deprecated("dijit.Editor::setDisabled is deprecated","use dijit.Editor::attr(\"disabled\",boolean) instead",2);this.attr("disabled",_4e);},_setValueAttr:function(_4f){this.setValue(_4f);},_getDisableSpellCheckAttr:function(){return !_4.attr(this.document.body,"spellcheck");},_setDisableSpellCheckAttr:function(_50){if(this.document){_4.attr(this.document.body,"spellcheck",!_50);}else{this.onLoadDeferred.addCallback(_4.hitch(this,function(){_4.attr(this.document.body,"spellcheck",!_50);}));}},onKeyPress:function(e){var c=(e.keyChar&&e.keyChar.toLowerCase())||e.keyCode;var _53=this._keyHandlers[c];var _54=arguments;if(_53&&!e.altKey){_4.forEach(_53,function(h){if((!!h.shift==!!e.shiftKey)&&(!!h.ctrl==!!e.ctrlKey)){if(!h.handler.apply(this,_54)){e.preventDefault();}}},this);}if(!this._onKeyHitch){this._onKeyHitch=_4.hitch(this,"onKeyPressed");}setTimeout(this._onKeyHitch,1);return true;},addKeyHandler:function(key,_57,_58,_59){if(!_4.isArray(this._keyHandlers[key])){this._keyHandlers[key]=[];}this._keyHandlers[key].push({shift:_58||false,ctrl:_57||false,handler:_59});},onKeyPressed:function(){this.onDisplayChanged();},onClick:function(e){this.onDisplayChanged(e);},_onIEMouseDown:function(e){if(!this._focused&&!this.disabled){this.focus();}},_onBlur:function(e){this.inherited(arguments);var _c=this.getValue(true);if(_c!=this.savedContent){this.onChange(_c);this.savedContent=_c;}if(_4.isMoz&&this.iframe){var _5e=_4.isFF<3?this.iframe.contentDocument:this.iframe;_5e.title=this._localizedIframeTitles.iframeEditTitle;}},_onFocus:function(e){if(!this.disabled){if(!this._disabledOK){this.attr("disabled",false);}this.inherited(arguments);}},blur:function(){if(!_4.isIE&&this.window.document.documentElement&&this.window.document.documentElement.focus){this.window.document.documentElement.focus();}else{if(_4.doc.body.focus){_4.doc.body.focus();}}},focus:function(){if(!_4.isIE){_5.focus(this.iframe);}else{if(this.editNode&&this.editNode.focus){this.iframe.fireEvent("onfocus",document.createEventObject());}}},updateInterval:200,_updateTimer:null,onDisplayChanged:function(e){if(this._updateTimer){clearTimeout(this._updateTimer);}if(!this._updateHandler){this._updateHandler=_4.hitch(this,"onNormalizedDisplayChanged");}this._updateTimer=setTimeout(this._updateHandler,this.updateInterval);},onNormalizedDisplayChanged:function(){delete this._updateTimer;},onChange:function(_61){},_normalizeCommand:function(cmd){var _63=cmd.toLowerCase();if(_63=="formatblock"){if(_4.isSafari){_63="heading";}}else{if(_63=="hilitecolor"&&!_4.isMoz){_63="backcolor";}}return _63;},_qcaCache:{},queryCommandAvailable:function(_64){var ca=this._qcaCache[_64];if(ca!=undefined){return ca;}return (this._qcaCache[_64]=this._queryCommandAvailable(_64));},_queryCommandAvailable:function(_66){var ie=1;var _68=1<<1;var _69=1<<2;var _6a=1<<3;var _6b=1<<4;var _6c=_4.isWebKit;function _6d(_6e){return {ie:Boolean(_6e&ie),mozilla:Boolean(_6e&_68),webkit:Boolean(_6e&_69),webkit420:Boolean(_6e&_6b),opera:Boolean(_6e&_6a)};};var _6f=null;switch(_66.toLowerCase()){case "bold":case "italic":case "underline":case "subscript":case "superscript":case "fontname":case "fontsize":case "forecolor":case "hilitecolor":case "justifycenter":case "justifyfull":case "justifyleft":case "justifyright":case "delete":case "selectall":case "toggledir":_6f=_6d(_68|ie|_69|_6a);break;case "createlink":case "unlink":case "removeformat":case "inserthorizontalrule":case "insertimage":case "insertorderedlist":case "insertunorderedlist":case "indent":case "outdent":case "formatblock":case "inserthtml":case "undo":case "redo":case "strikethrough":case "tabindent":_6f=_6d(_68|ie|_6a|_6b);break;case "blockdirltr":case "blockdirrtl":case "dirltr":case "dirrtl":case "inlinedirltr":case "inlinedirrtl":_6f=_6d(ie);break;case "cut":case "copy":case "paste":_6f=_6d(ie|_68|_6b);break;case "inserttable":_6f=_6d(_68|ie);break;case "insertcell":case "insertcol":case "insertrow":case "deletecells":case "deletecols":case "deleterows":case "mergecells":case "splitcell":_6f=_6d(ie|_68);break;default:return false;}return (_4.isIE&&_6f.ie)||(_4.isMoz&&_6f.mozilla)||(_4.isWebKit&&_6f.webkit)||(_4.isWebKit>420&&_6f.webkit420)||(_4.isOpera&&_6f.opera);},execCommand:function(_70,_71){var _72;this.focus();_70=this._normalizeCommand(_70);if(_71!=undefined){if(_70=="heading"){throw new Error("unimplemented");}else{if((_70=="formatblock")&&_4.isIE){_71="<"+_71+">";}}}if(_70=="inserthtml"){_71=this._preFilterContent(_71);_72=true;if(_4.isIE){var _73=this.document.selection.createRange();if(this.document.selection.type.toUpperCase()=="CONTROL"){var n=_73.item(0);while(_73.length){_73.remove(_73.item(0));}n.outerHTML=_71;}else{_73.pasteHTML(_71);}_73.select();}else{if(_4.isMoz&&!_71.length){this._sCall("remove");}else{_72=this.document.execCommand(_70,false,_71);}}}else{if((_70=="unlink")&&(this.queryCommandEnabled("unlink"))&&(_4.isMoz||_4.isWebKit)){var a=this._sCall("getAncestorElement",["a"]);this._sCall("selectElement",[a]);_72=this.document.execCommand("unlink",false,null);}else{if((_70=="hilitecolor")&&(_4.isMoz)){this.document.execCommand("styleWithCSS",false,true);_72=this.document.execCommand(_70,false,_71);this.document.execCommand("styleWithCSS",false,false);}else{if((_4.isIE)&&((_70=="backcolor")||(_70=="forecolor"))){_71=arguments.length>1?_71:null;_72=this.document.execCommand(_70,false,_71);}else{_71=arguments.length>1?_71:null;if(_71||_70!="createlink"){_72=this.document.execCommand(_70,false,_71);}}}}}this.onDisplayChanged();return _72;},queryCommandEnabled:function(_76){if(this.disabled||!this._disabledOK){return false;}_76=this._normalizeCommand(_76);if(_4.isMoz||_4.isWebKit){if(_76=="unlink"){this._sCall("hasAncestorElement",["a"]);}else{if(_76=="inserttable"){return true;}}}if(_4.isWebKit){if(_76=="copy"){_76="cut";}else{if(_76=="paste"){return true;}}}var _77=_4.isIE?this.document.selection.createRange():this.document;return _77.queryCommandEnabled(_76);},queryCommandState:function(_78){if(this.disabled||!this._disabledOK){return false;}_78=this._normalizeCommand(_78);return this.document.queryCommandState(_78);},queryCommandValue:function(_79){if(this.disabled||!this._disabledOK){return false;}var r;_79=this._normalizeCommand(_79);if(_4.isIE&&_79=="formatblock"){r=this._native2LocalFormatNames[this.document.queryCommandValue(_79)];}else{r=this.document.queryCommandValue(_79);}return r;},_sCall:function(_7b,_7c){return _4.withGlobal(this.window,_7b,_5._editor.selection,_7c);},placeCursorAtStart:function(){this.focus();var _7d=false;if(_4.isMoz){var _7e=this.editNode.firstChild;while(_7e){if(_7e.nodeType==3){if(_7e.nodeValue.replace(/^\s+|\s+$/g,"").length>0){_7d=true;this._sCall("selectElement",[_7e]);break;}}else{if(_7e.nodeType==1){_7d=true;this._sCall("selectElementChildren",[_7e]);break;}}_7e=_7e.nextSibling;}}else{_7d=true;this._sCall("selectElementChildren",[this.editNode]);}if(_7d){this._sCall("collapse",[true]);}},placeCursorAtEnd:function(){this.focus();var _7f=false;if(_4.isMoz){var _80=this.editNode.lastChild;while(_80){if(_80.nodeType==3){if(_80.nodeValue.replace(/^\s+|\s+$/g,"").length>0){_7f=true;this._sCall("selectElement",[_80]);break;}}else{if(_80.nodeType==1){_7f=true;if(_80.lastChild){this._sCall("selectElement",[_80.lastChild]);}else{this._sCall("selectElement",[_80]);}break;}}_80=_80.previousSibling;}}else{_7f=true;this._sCall("selectElementChildren",[this.editNode]);}if(_7f){this._sCall("collapse",[false]);}},getValue:function(_81){if(this.textarea){if(this.isClosed||!this.isLoaded){return this.textarea.value;}}return this._postFilterContent(null,_81);},_getValueAttr:function(){return this.getValue();},setValue:function(_82){if(!this.isLoaded){this.onLoadDeferred.addCallback(_4.hitch(this,function(){this.setValue(_82);}));return;}if(this.textarea&&(this.isClosed||!this.isLoaded)){this.textarea.value=_82;}else{_82=this._preFilterContent(_82);var _83=this.isClosed?this.domNode:this.editNode;_83.innerHTML=_82;this._preDomFilterContent(_83);}this.onDisplayChanged();},replaceValue:function(_84){if(this.isClosed){this.setValue(_84);}else{if(this.window&&this.window.getSelection&&!_4.isMoz){this.setValue(_84);}else{if(this.window&&this.window.getSelection){_84=this._preFilterContent(_84);this.execCommand("selectall");if(_4.isMoz&&!_84){_84="&nbsp;";}this.execCommand("inserthtml",_84);this._preDomFilterContent(this.editNode);}else{if(this.document&&this.document.selection){this.setValue(_84);}}}}},_preFilterContent:function(_85){var ec=_85;_4.forEach(this.contentPreFilters,function(ef){if(ef){ec=ef(ec);}});return ec;},_preDomFilterContent:function(dom){dom=dom||this.editNode;_4.forEach(this.contentDomPreFilters,function(ef){if(ef&&_4.isFunction(ef)){ef(dom);}},this);},_postFilterContent:function(dom,_8b){var ec;if(!_4.isString(dom)){dom=dom||this.editNode;if(this.contentDomPostFilters.length){if(_8b){dom=_4.clone(dom);}_4.forEach(this.contentDomPostFilters,function(ef){dom=ef(dom);});}ec=_5._editor.getChildrenHtml(dom);}else{ec=dom;}if(!_4.trim(ec.replace(/^\xA0\xA0*/,"").replace(/\xA0\xA0*$/,"")).length){ec="";}_4.forEach(this.contentPostFilters,function(ef){ec=ef(ec);});return ec;},_saveContent:function(e){var _90=_4.byId(_5._scopeName+"._editor.RichText.savedContent");_90.value+=this._SEPARATOR+this.name+":"+this.getValue();},escapeXml:function(str,_92){str=str.replace(/&/gm,"&amp;").replace(/</gm,"&lt;").replace(/>/gm,"&gt;").replace(/"/gm,"&quot;");if(!_92){str=str.replace(/'/gm,"&#39;");}return str;},getNodeHtml:function(_93){_4.deprecated("dijit.Editor::getNodeHtml is deprecated","use dijit._editor.getNodeHtml instead",2);return _5._editor.getNodeHtml(_93);},getNodeChildrenHtml:function(dom){_4.deprecated("dijit.Editor::getNodeChildrenHtml is deprecated","use dijit._editor.getChildrenHtml instead",2);return _5._editor.getChildrenHtml(dom);},close:function(_95,_96){if(this.isClosed){return false;}if(!arguments.length){_95=true;}this._content=this.getValue();var _97=(this.savedContent!=this._content);if(this.interval){clearInterval(this.interval);}if(this._webkitListener){this.disconnect(this._webkitListener);delete this._webkitListener;}if(_4.isIE){this.iframe.onfocus=null;}this.iframe._loadFunc=null;if(this.textarea){var s=this.textarea.style;s.position="";s.left=s.top="";if(_4.isIE){s.overflow=this.__overflow;this.__overflow=null;}this.textarea.value=_95?this._content:this.savedContent;_4.destroy(this.domNode);this.domNode=this.textarea;}else{this.domNode.innerHTML=_95?this._content:this.savedContent;}_4.removeClass(this.domNode,"RichTextEditable");this.isClosed=true;this.isLoaded=false;delete this.editNode;if(this.window&&this.window._frameElement){this.window._frameElement=null;}this.window=null;this.document=null;this.editingArea=null;this.editorObject=null;return _97;},destroyRendering:function(){},destroy:function(){this.destroyRendering();if(!this.isClosed){this.close(false);}this.inherited(arguments);},_removeMozBogus:function(_99){return _99.replace(/\stype="_moz"/gi,"").replace(/\s_moz_dirty=""/gi,"");},_removeSafariBogus:function(_9a){return _9a.replace(/\sclass="webkit-block-placeholder"/gi,"");},_fixContentForMoz:function(_9b){return _9b.replace(/<(\/)?strong([ \>])/gi,"<$1b$2").replace(/<(\/)?em([ \>])/gi,"<$1i$2");},_preFixUrlAttributes:function(_9c){return _9c.replace(/(?:(<a(?=\s).*?\shref=)("|')(.*?)\2)|(?:(<a\s.*?href=)([^"'][^ >]+))/gi,"$1$4$2$3$5$2 _djrealurl=$2$3$5$2").replace(/(?:(<img(?=\s).*?\ssrc=)("|')(.*?)\2)|(?:(<img\s.*?src=)([^"'][^ >]+))/gi,"$1$4$2$3$5$2 _djrealurl=$2$3$5$2");}});}}};});