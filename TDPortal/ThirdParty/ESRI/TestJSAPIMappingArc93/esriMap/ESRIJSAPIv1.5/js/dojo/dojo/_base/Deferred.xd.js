/*
	Copyright (c) 2004-2009, The Dojo Foundation All Rights Reserved.
	Available via Academic Free License >= 2.1 OR the modified BSD license.
	see: http://dojotoolkit.org/license for details
*/


dojo._xdResourceLoaded(function(_1,_2,_3){return {depends:[["provide","dojo._base.Deferred"],["require","dojo._base.lang"]],defineResource:function(_4,_5,_6){if(!_4._hasResource["dojo._base.Deferred"]){_4._hasResource["dojo._base.Deferred"]=true;_4.provide("dojo._base.Deferred");_4.require("dojo._base.lang");_4.Deferred=function(_7){this.chain=[];this.id=this._nextId();this.fired=-1;this.paused=0;this.results=[null,null];this.canceller=_7;this.silentlyCancelled=false;};_4.extend(_4.Deferred,{_nextId:(function(){var n=1;return function(){return n++;};})(),cancel:function(){var _9;if(this.fired==-1){if(this.canceller){_9=this.canceller(this);}else{this.silentlyCancelled=true;}if(this.fired==-1){if(!(_9 instanceof Error)){var _a=_9;var _b="Deferred Cancelled";if(_9&&_9.toString){_b+=": "+_9.toString();}_9=new Error(_b);_9.dojoType="cancel";_9.cancelResult=_a;}this.errback(_9);}}else{if((this.fired==0)&&(this.results[0] instanceof _4.Deferred)){this.results[0].cancel();}}},_resback:function(_c){this.fired=((_c instanceof Error)?1:0);this.results[this.fired]=_c;this._fire();},_check:function(){if(this.fired!=-1){if(!this.silentlyCancelled){throw new Error("already called!");}this.silentlyCancelled=false;return;}},callback:function(_d){this._check();this._resback(_d);},errback:function(_e){this._check();if(!(_e instanceof Error)){_e=new Error(_e);}this._resback(_e);},addBoth:function(cb,_10){var _11=_4.hitch.apply(_4,arguments);return this.addCallbacks(_11,_11);},addCallback:function(cb,_13){return this.addCallbacks(_4.hitch.apply(_4,arguments));},addErrback:function(cb,_15){return this.addCallbacks(null,_4.hitch.apply(_4,arguments));},addCallbacks:function(cb,eb){this.chain.push([cb,eb]);if(this.fired>=0){this._fire();}return this;},_fire:function(){var _18=this.chain;var _19=this.fired;var res=this.results[_19];var _1b=this;var cb=null;while((_18.length>0)&&(this.paused==0)){var f=_18.shift()[_19];if(!f){continue;}var _1e=function(){var ret=f(res);if(typeof ret!="undefined"){res=ret;}_19=((res instanceof Error)?1:0);if(res instanceof _4.Deferred){cb=function(res){_1b._resback(res);_1b.paused--;if((_1b.paused==0)&&(_1b.fired>=0)){_1b._fire();}};this.paused++;}};if(_4.config.debugAtAllCosts){_1e.call(this);}else{try{_1e.call(this);}catch(err){_19=1;res=err;}}}this.fired=_19;this.results[_19]=res;if((cb)&&(this.paused)){res.addBoth(cb);}}});}}};});