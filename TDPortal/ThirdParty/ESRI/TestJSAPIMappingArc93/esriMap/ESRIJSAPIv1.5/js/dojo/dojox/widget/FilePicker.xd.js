/*
	Copyright (c) 2004-2009, The Dojo Foundation All Rights Reserved.
	Available via Academic Free License >= 2.1 OR the modified BSD license.
	see: http://dojotoolkit.org/license for details
*/


dojo._xdResourceLoaded(function(_1,_2,_3){return {depends:[["provide","dojox.widget.FilePicker"],["require","dojox.widget.RollingList"],["require","dojo.i18n"],["requireLocalization","dojox.widget","FilePicker",null,"ROOT,ar,ca,cs,da,de,el,es,fi,fr,he,hu,it,ja,ko,nb,nl,pl,pt,pt-pt,ru,sk,sl,sv,th,tr,zh,zh-tw","ROOT,ar,ca,cs,da,de,el,es,fi,fr,he,hu,it,ja,ko,nb,nl,pl,pt,pt-pt,ru,sk,sl,sv,th,tr,zh,zh-tw"]],defineResource:function(_4,_5,_6){if(!_4._hasResource["dojox.widget.FilePicker"]){_4._hasResource["dojox.widget.FilePicker"]=true;_4.provide("dojox.widget.FilePicker");_4.require("dojox.widget.RollingList");_4.require("dojo.i18n");_4.declare("dojox.widget._FileInfoPane",[_6.widget._RollingListPane],{templateString:"",templateString:"<div class=\"dojoxFileInfoPane\">\r\n\t<table>\r\n\t\t<tbody>\r\n\t\t\t<tr>\r\n\t\t\t\t<td class=\"dojoxFileInfoLabel dojoxFileInfoNameLabel\">${_messages.name}</td>\r\n\t\t\t\t<td class=\"dojoxFileInfoName\" dojoAttachPoint=\"nameNode\"></td>\r\n\t\t\t</tr>\r\n\t\t\t<tr>\r\n\t\t\t\t<td class=\"dojoxFileInfoLabel dojoxFileInfoPathLabel\">${_messages.path}</td>\r\n\t\t\t\t<td class=\"dojoxFileInfoPath\" dojoAttachPoint=\"pathNode\"></td>\r\n\t\t\t</tr>\r\n\t\t\t<tr>\r\n\t\t\t\t<td class=\"dojoxFileInfoLabel dojoxFileInfoSizeLabel\">${_messages.size}</td>\r\n\t\t\t\t<td class=\"dojoxFileInfoSize\" dojoAttachPoint=\"sizeNode\"></td>\r\n\t\t\t</tr>\r\n\t\t</tbody>\r\n\t</table>\r\n\t<div dojoAttachPoint=\"containerNode\" style=\"display:none;\"></div>\r\n</div>\r\n",postMixInProperties:function(){this._messages=_4.i18n.getLocalization("dojox.widget","FilePicker",this.lang);this.inherited(arguments);},onItems:function(){var _7=this.store,_8=this.items[0];if(!_8){this._onError("Load",new Error("No item defined"));}else{this.nameNode.innerHTML=_7.getLabel(_8);this.pathNode.innerHTML=_7.getIdentity(_8);this.sizeNode.innerHTML=_7.getValue(_8,"size");this.parentWidget.scrollIntoView(this);this.inherited(arguments);}}});_4.declare("dojox.widget.FilePicker",_6.widget.RollingList,{className:"dojoxFilePicker",pathSeparator:"",topDir:"",parentAttr:"parentDir",pathAttr:"path",preloadItems:50,selectDirectories:true,selectFiles:true,_itemsMatch:function(_9,_a){if(!_9&&!_a){return true;}else{if(!_9||!_a){return false;}else{if(_9==_a){return true;}else{if(this._isIdentity){var _b=[this.store.getIdentity(_9),this.store.getIdentity(_a)];_4.forEach(_b,function(i,_d){if(i.lastIndexOf(this.pathSeparator)==(i.length-1)){_b[_d]=i.substring(0,i.length-1);}else{}},this);return (_b[0]==_b[1]);}}}}return false;},startup:function(){if(this._started){return;}this.inherited(arguments);var _e,_f=this.getChildren()[0];var _10=_4.hitch(this,function(){if(_e){this.disconnect(_e);}delete _e;var _11=_f.items[0];if(_11){var _12=this.store;var _13=_12.getValue(_11,this.parentAttr);var _14=_12.getValue(_11,this.pathAttr);this.pathSeparator=this.pathSeparator||_12.pathSeparator;if(!this.pathSeparator){this.pathSeparator=_14.substring(_13.length,_13.length+1);}if(!this.topDir){this.topDir=_13;if(this.topDir.lastIndexOf(this.pathSeparator)!=(this.topDir.length-1)){this.topDir+=this.pathSeparator;}}}});if(!this.pathSeparator||!this.topDir){if(!_f.items){_e=this.connect(_f,"onItems",_10);}else{_10();}}},getChildItems:function(_15){var ret=this.inherited(arguments);if(!ret&&this.store.getValue(_15,"directory")){ret=[];}return ret;},getMenuItemForItem:function(_17,_18,_19){var _1a={iconClass:"dojoxDirectoryItemIcon"};if(!this.store.getValue(_17,"directory")){_1a.iconClass="dojoxFileItemIcon";var l=this.store.getLabel(_17),idx=l.lastIndexOf(".");if(idx>=0){_1a.iconClass+=" dojoxFileItemIcon_"+l.substring(idx+1);}if(!this.selectFiles){_1a.disabled=true;}}var ret=new _5.MenuItem(_1a);return ret;},getPaneForItem:function(_1e,_1f,_20){var ret=null;if(!_1e||(this.store.isItem(_1e)&&this.store.getValue(_1e,"directory"))){ret=new _6.widget._RollingListGroupPane({});}else{if(this.store.isItem(_1e)&&!this.store.getValue(_1e,"directory")){ret=new _6.widget._FileInfoPane({});}}return ret;},_setPathValueAttr:function(_22,_23,_24){if(!_22){this.attr("value",null);return;}if(_22.lastIndexOf(this.pathSeparator)==(_22.length-1)){_22=_22.substring(0,_22.length-1);}this.store.fetchItemByIdentity({identity:_22,onItem:function(v){if(_23){this._lastExecutedValue=v;}this.attr("value",v);if(_24){_24();}},scope:this});},_getPathValueAttr:function(val){if(!val){val=this.value;}if(val&&this.store.isItem(val)){return this.store.getValue(val,this.pathAttr);}else{return "";}},_setValue:function(_27){delete this._setInProgress;var _28=this.store;if(_27&&_28.isItem(_27)){var _29=this.store.getValue(_27,"directory");if((_29&&!this.selectDirectories)||(!_29&&!this.selectFiles)){return;}}else{_27=null;}if(!this._itemsMatch(this.value,_27)){this.value=_27;this._onChange(_27);}}});}}};});