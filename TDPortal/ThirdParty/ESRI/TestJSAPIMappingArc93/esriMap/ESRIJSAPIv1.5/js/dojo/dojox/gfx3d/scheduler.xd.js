/*
	Copyright (c) 2004-2009, The Dojo Foundation All Rights Reserved.
	Available via Academic Free License >= 2.1 OR the modified BSD license.
	see: http://dojotoolkit.org/license for details
*/


dojo._xdResourceLoaded(function(_1,_2,_3){return {depends:[["provide","dojox.gfx3d.scheduler"],["provide","dojox.gfx3d.drawer"],["require","dojox.gfx3d.vector"]],defineResource:function(_4,_5,_6){if(!_4._hasResource["dojox.gfx3d.scheduler"]){_4._hasResource["dojox.gfx3d.scheduler"]=true;_4.provide("dojox.gfx3d.scheduler");_4.provide("dojox.gfx3d.drawer");_4.require("dojox.gfx3d.vector");_4.mixin(_6.gfx3d.scheduler,{zOrder:function(_7,_8){_8=_8?_8:_6.gfx3d.scheduler.order;_7.sort(function(a,b){return _8(b)-_8(a);});return _7;},bsp:function(_b,_c){_c=_c?_c:_6.gfx3d.scheduler.outline;var p=new _6.gfx3d.scheduler.BinarySearchTree(_b[0],_c);_4.forEach(_b.slice(1),function(_e){p.add(_e,_c);});return p.iterate(_c);},order:function(it){return it.getZOrder();},outline:function(it){return it.getOutline();}});_4.declare("dojox.gfx3d.scheduler.BinarySearchTree",null,{constructor:function(obj,_12){this.plus=null;this.minus=null;this.object=obj;var o=_12(obj);this.orient=o[0];this.normal=_6.gfx3d.vector.normalize(o);},add:function(obj,_15){var _16=0.5,o=_15(obj),v=_6.gfx3d.vector,n=this.normal,a=this.orient,BST=_6.gfx3d.scheduler.BinarySearchTree;if(_4.every(o,function(_1c){return Math.floor(_16+v.dotProduct(n,v.substract(_1c,a)))<=0;})){if(this.minus){this.minus.add(obj,_15);}else{this.minus=new BST(obj,_15);}}else{if(_4.every(o,function(_1d){return Math.floor(_16+v.dotProduct(n,v.substract(_1d,a)))>=0;})){if(this.plus){this.plus.add(obj,_15);}else{this.plus=new BST(obj,_15);}}else{throw "The case: polygon cross siblings' plate is not implemneted yet";}}},iterate:function(_1e){var _1f=0.5;var v=_6.gfx3d.vector;var _21=[];var _22=null;var _23={x:0,y:0,z:-10000};if(Math.floor(_1f+v.dotProduct(this.normal,v.substract(_23,this.orient)))<=0){_22=[this.plus,this.minus];}else{_22=[this.minus,this.plus];}if(_22[0]){_21=_21.concat(_22[0].iterate());}_21.push(this.object);if(_22[1]){_21=_21.concat(_22[1].iterate());}return _21;}});_4.mixin(_6.gfx3d.drawer,{conservative:function(_24,_25,_26){_4.forEach(this.objects,function(_27){_27.destroy();});_4.forEach(_25,function(_28){_28.draw(_26.lighting);});},chart:function(_29,_2a,_2b){_4.forEach(this.todos,function(_2c){_2c.draw(_2b.lighting);});}});}}};});