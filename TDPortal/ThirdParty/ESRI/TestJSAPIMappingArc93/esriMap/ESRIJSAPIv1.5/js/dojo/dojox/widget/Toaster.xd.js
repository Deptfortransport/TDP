/*
	Copyright (c) 2004-2009, The Dojo Foundation All Rights Reserved.
	Available via Academic Free License >= 2.1 OR the modified BSD license.
	see: http://dojotoolkit.org/license for details
*/


dojo._xdResourceLoaded(function(_1,_2,_3){return {depends:[["provide","dojox.widget.Toaster"],["require","dojo.fx"],["require","dijit._Widget"],["require","dijit._Templated"]],defineResource:function(_4,_5,_6){if(!_4._hasResource["dojox.widget.Toaster"]){_4._hasResource["dojox.widget.Toaster"]=true;_4.provide("dojox.widget.Toaster");_4.require("dojo.fx");_4.require("dijit._Widget");_4.require("dijit._Templated");_4.declare("dojox.widget.Toaster",[_5._Widget,_5._Templated],{templateString:"<div dojoAttachPoint=\"clipNode\"><div dojoAttachPoint=\"containerNode\" dojoAttachEvent=\"onclick:onSelect\"><div dojoAttachPoint=\"contentNode\"></div></div></div>",messageTopic:"",messageTypes:{MESSAGE:"message",WARNING:"warning",ERROR:"error",FATAL:"fatal"},defaultType:"message",positionDirection:"br-up",positionDirectionTypes:["br-up","br-left","bl-up","bl-right","tr-down","tr-left","tl-down","tl-right"],duration:2000,slideDuration:500,separator:"<hr></hr>",postCreate:function(){this.inherited(arguments);this.hide();_4.body().appendChild(this.domNode);this.clipNode.className="dijitToasterClip";this.containerNode.className+=" dijitToasterContainer";this.contentNode.className="dijitToasterContent";if(this.messageTopic){_4.subscribe(this.messageTopic,this,"_handleMessage");}},_handleMessage:function(_7){if(_4.isString(_7)){this.setContent(_7);}else{this.setContent(_7.message,_7.type,_7.duration);}},_capitalize:function(w){return w.substring(0,1).toUpperCase()+w.substring(1);},setContent:function(_9,_a,_b){_b=_b||this.duration;if(this.slideAnim){if(this.slideAnim.status()!="playing"){this.slideAnim.stop();}if(this.slideAnim.status()=="playing"||(this.fadeAnim&&this.fadeAnim.status()=="playing")){setTimeout(_4.hitch(this,function(){this.setContent(_9,_a,_b);}),50);return;}}for(var _c in this.messageTypes){_4.removeClass(this.containerNode,"dijitToaster"+this._capitalize(this.messageTypes[_c]));}_4.style(this.containerNode,"opacity",1);this._setContent(_9);_4.addClass(this.containerNode,"dijitToaster"+this._capitalize(_a||this.defaultType));this.show();var _d=_4.marginBox(this.containerNode);this._cancelHideTimer();if(this.isVisible){this._placeClip();if(!this._stickyMessage){this._setHideTimer(_b);}}else{var _e=this.containerNode.style;var pd=this.positionDirection;if(pd.indexOf("-up")>=0){_e.left=0+"px";_e.top=_d.h+10+"px";}else{if(pd.indexOf("-left")>=0){_e.left=_d.w+10+"px";_e.top=0+"px";}else{if(pd.indexOf("-right")>=0){_e.left=0-_d.w-10+"px";_e.top=0+"px";}else{if(pd.indexOf("-down")>=0){_e.left=0+"px";_e.top=0-_d.h-10+"px";}else{throw new Error(this.id+".positionDirection is invalid: "+pd);}}}}this.slideAnim=_4.fx.slideTo({node:this.containerNode,top:0,left:0,duration:this.slideDuration});this.connect(this.slideAnim,"onEnd",function(_10,_11){this.fadeAnim=_4.fadeOut({node:this.containerNode,duration:1000});this.connect(this.fadeAnim,"onEnd",function(evt){this.isVisible=false;this.hide();});this._setHideTimer(_b);this.connect(this,"onSelect",function(evt){this._cancelHideTimer();this._stickyMessage=false;this.fadeAnim.play();});this.isVisible=true;});this.slideAnim.play();}},_setContent:function(_14){if(_4.isFunction(_14)){_14(this);return;}if(_14&&this.isVisible){_14=this.contentNode.innerHTML+this.separator+_14;}this.contentNode.innerHTML=_14;},_cancelHideTimer:function(){if(this._hideTimer){clearTimeout(this._hideTimer);this._hideTimer=null;}},_setHideTimer:function(_15){this._cancelHideTimer();if(_15>0){this._cancelHideTimer();this._hideTimer=setTimeout(_4.hitch(this,function(evt){if(this.bgIframe&&this.bgIframe.iframe){this.bgIframe.iframe.style.display="none";}this._hideTimer=null;this._stickyMessage=false;this.fadeAnim.play();}),_15);}else{this._stickyMessage=true;}},_placeClip:function(){var _17=_5.getViewport();var _18=_4.marginBox(this.containerNode);var _19=this.clipNode.style;_19.height=_18.h+"px";_19.width=_18.w+"px";var pd=this.positionDirection;if(pd.match(/^t/)){_19.top=_17.t+"px";}else{if(pd.match(/^b/)){_19.top=(_17.h-_18.h-2+_17.t)+"px";}}if(pd.match(/^[tb]r-/)){_19.left=(_17.w-_18.w-1-_17.l)+"px";}else{if(pd.match(/^[tb]l-/)){_19.left=0+"px";}}_19.clip="rect(0px, "+_18.w+"px, "+_18.h+"px, 0px)";if(_4.isIE){if(!this.bgIframe){this.clipNode.id=_5.getUniqueId("dojox_widget_Toaster_clipNode");this.bgIframe=new _5.BackgroundIframe(this.clipNode);}var _1b=this.bgIframe.iframe;if(_1b){_1b.style.display="block";}}},onSelect:function(e){},show:function(){_4.style(this.domNode,"display","block");this._placeClip();if(!this._scrollConnected){this._scrollConnected=_4.connect(window,"onscroll",this,this._placeClip);}},hide:function(){_4.style(this.domNode,"display","none");if(this._scrollConnected){_4.disconnect(this._scrollConnected);this._scrollConnected=false;}_4.style(this.containerNode,"opacity",1);}});}}};});