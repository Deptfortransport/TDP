/*
	Copyright (c) 2004-2009, The Dojo Foundation All Rights Reserved.
	Available via Academic Free License >= 2.1 OR the modified BSD license.
	see: http://dojotoolkit.org/license for details
*/


dojo._xdResourceLoaded(function(_1,_2,_3){return {depends:[["provide","dojox.grid.compat.Grid"],["require","dojox.grid.compat.VirtualGrid"],["require","dojox.grid.compat._data.model"],["require","dojox.grid.compat._data.editors"],["require","dojox.grid.compat._data.dijitEditors"]],defineResource:function(_4,_5,_6){if(!_4._hasResource["dojox.grid.compat.Grid"]){_4._hasResource["dojox.grid.compat.Grid"]=true;_4.provide("dojox.grid.compat.Grid");_4.require("dojox.grid.compat.VirtualGrid");_4.require("dojox.grid.compat._data.model");_4.require("dojox.grid.compat._data.editors");_4.require("dojox.grid.compat._data.dijitEditors");_4.declare("dojox.Grid",_6.VirtualGrid,{model:"dojox.grid.data.Table",postCreate:function(){if(this.model){var m=this.model;if(_4.isString(m)){m=_4.getObject(m);}this.model=(_4.isFunction(m))?new m():m;this._setModel(this.model);}this.inherited(arguments);},destroy:function(){this.setModel(null);this.inherited(arguments);},_structureChanged:function(){this.indexCellFields();this.inherited(arguments);},_setModel:function(_8){this.model=_8;if(this.model){this.model.observer(this);this.model.measure();this.indexCellFields();}},setModel:function(_9){if(this.model){this.model.notObserver(this);}this._setModel(_9);},get:function(_a){return this.grid.model.getDatum(_a,this.fieldIndex);},modelAllChange:function(){this.rowCount=(this.model?this.model.getRowCount():0);this.updateRowCount(this.rowCount);},modelBeginUpdate:function(){this.beginUpdate();},modelEndUpdate:function(){this.endUpdate();},modelRowChange:function(_b,_c){this.updateRow(_c);},modelDatumChange:function(_d,_e,_f){this.updateRow(_e);},modelFieldsChange:function(){this.indexCellFields();this.render();},modelInsertion:function(_10){this.updateRowCount(this.model.getRowCount());},modelRemoval:function(_11){this.updateRowCount(this.model.getRowCount());},getCellName:function(_12){var v=this.model.fields.values,i=_12.fieldIndex;return i>=0&&i<v.length&&v[i].name||this.inherited(arguments);},indexCellFields:function(){var _15=this.layout.cells;for(var i=0,c;_15&&(c=_15[i]);i++){if(_4.isString(c.field)){c.fieldIndex=this.model.fields.indexOf(c.field);}}},refresh:function(){this.edit.cancel();this.model.measure();},canSort:function(_18){var f=this.getSortField(_18);return f&&this.model.canSort(f);},getSortField:function(_1a){var c=this.getCell(this.getSortIndex(_1a));return (c.fieldIndex+1)*(this.sortInfo>0?1:-1);},sort:function(){this.edit.apply();this.model.sort(this.getSortField());},addRow:function(_1c,_1d){this.edit.apply();var i=_1d||-1;if(i<0){i=this.selection.getFirstSelected()||0;}if(i<0){i=0;}this.model.insert(_1c,i);this.model.beginModifyRow(i);for(var j=0,c;((c=this.getCell(j))&&!c.editor);j++){}if(c&&c.editor){this.edit.setEditCell(c,i);this.focus.setFocusCell(c,i);}else{this.focus.setFocusCell(this.getCell(0),i);}},removeSelectedRows:function(){this.edit.apply();var s=this.selection.getSelected();if(s.length){this.model.remove(s);this.selection.clear();}},canEdit:function(_22,_23){return (this.model.canModify?this.model.canModify(_23):true);},doStartEdit:function(_24,_25){this.model.beginModifyRow(_25);this.onStartEdit(_24,_25);},doApplyCellEdit:function(_26,_27,_28){this.model.setDatum(_26,_27,_28);this.onApplyCellEdit(_26,_27,_28);},doCancelEdit:function(_29){this.model.cancelModifyRow(_29);this.onCancelEdit.apply(this,arguments);},doApplyEdit:function(_2a){this.model.endModifyRow(_2a);this.onApplyEdit(_2a);},styleRowState:function(_2b){if(this.model.getState){var _2c=this.model.getState(_2b.index),c="";for(var i=0,ss=["inflight","error","inserting"],s;s=ss[i];i++){if(_2c[s]){c=" dojoxGrid-row-"+s;break;}}_2b.customClasses+=c;}},onStyleRow:function(_31){this.styleRowState(_31);this.inherited(arguments);}});_6.Grid.markupFactory=function(_32,_33,_34){var d=_4;var _36=function(n){var w=d.attr(n,"width")||"auto";if((w!="auto")&&(w.substr(-2)!="em")){w=parseInt(w)+"px";}return w;};if(!_32.model&&d.hasAttr(_33,"store")){var _39=_33.cloneNode(false);d.attr(_39,{"jsId":null,"dojoType":d.attr(_33,"dataModelClass")||"dojox.grid.data.DojoData"});_32.model=d.parser.instantiate([_39])[0];}if(!_32.structure&&_33.nodeName.toLowerCase()=="table"){_32.structure=d.query("> colgroup",_33).map(function(cg){var sv=d.attr(cg,"span");var v={noscroll:(d.attr(cg,"noscroll")=="true")?true:false,__span:(!!sv?parseInt(sv):1),cells:[]};if(d.hasAttr(cg,"width")){v.width=_36(cg);}return v;});if(!_32.structure.length){_32.structure.push({__span:Infinity,cells:[]});}d.query("thead > tr",_33).forEach(function(tr,_3e){var _3f=0;var _40=0;var _41;var _42=null;d.query("> th",tr).map(function(th){if(!_42){_41=0;_42=_32.structure[0];}else{if(_3f>=(_41+_42.__span)){_40++;_41+=_42.__span;var _44=_42;_42=_32.structure[_40];}}var _45={name:d.trim(d.attr(th,"name")||th.innerHTML),field:d.trim(d.attr(th,"field")||""),colSpan:parseInt(d.attr(th,"colspan")||1)};_3f+=_45.colSpan;_45.field=_45.field||_45.name;_45.width=_36(th);if(!_42.cells[_3e]){_42.cells[_3e]=[];}_42.cells[_3e].push(_45);});});}return new _6.Grid(_32,_33);};_6.grid.Grid=_6.Grid;}}};});