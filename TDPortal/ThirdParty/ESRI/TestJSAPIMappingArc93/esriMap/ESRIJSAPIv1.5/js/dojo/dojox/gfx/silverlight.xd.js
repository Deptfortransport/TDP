/*
	Copyright (c) 2004-2009, The Dojo Foundation All Rights Reserved.
	Available via Academic Free License >= 2.1 OR the modified BSD license.
	see: http://dojotoolkit.org/license for details
*/


dojo._xdResourceLoaded(function(_1,_2,_3){return {depends:[["provide","dojox.gfx.silverlight"],["require","dojox.gfx._base"],["require","dojox.gfx.shape"],["require","dojox.gfx.path"]],defineResource:function(_4,_5,_6){if(!_4._hasResource["dojox.gfx.silverlight"]){_4._hasResource["dojox.gfx.silverlight"]=true;_4.provide("dojox.gfx.silverlight");_4.require("dojox.gfx._base");_4.require("dojox.gfx.shape");_4.require("dojox.gfx.path");_4.experimental("dojox.gfx.silverlight");_6.gfx.silverlight.dasharray={solid:"none",shortdash:[4,1],shortdot:[1,1],shortdashdot:[4,1,1,1],shortdashdotdot:[4,1,1,1,1,1],dot:[1,3],dash:[4,3],longdash:[8,3],dashdot:[4,3,1,3],longdashdot:[8,3,1,3],longdashdotdot:[8,3,1,3,1,3]};_6.gfx.silverlight.fontweight={normal:400,bold:700};_6.gfx.silverlight.caps={butt:"Flat",round:"Round",square:"Square"};_6.gfx.silverlight.joins={bevel:"Bevel",round:"Round"};_6.gfx.silverlight.fonts={serif:"Times New Roman",times:"Times New Roman","sans-serif":"Arial",helvetica:"Arial",monotone:"Courier New",courier:"Courier New"};_6.gfx.silverlight.hexColor=function(_7){var c=_6.gfx.normalizeColor(_7),t=c.toHex(),a=Math.round(c.a*255);a=(a<0?0:a>255?255:a).toString(16);return "#"+(a.length<2?"0"+a:a)+t.slice(1);};_4.extend(_6.gfx.Shape,{setFill:function(_b){var p=this.rawNode.getHost().content,r=this.rawNode,f;if(!_b){this.fillStyle=null;this._setFillAttr(null);return this;}if(typeof (_b)=="object"&&"type" in _b){switch(_b.type){case "linear":this.fillStyle=f=_6.gfx.makeParameters(_6.gfx.defaultLinearGradient,_b);var _f=p.createFromXaml("<LinearGradientBrush/>");_f.mappingMode="Absolute";_f.startPoint=f.x1+","+f.y1;_f.endPoint=f.x2+","+f.y2;_4.forEach(f.colors,function(c){var t=p.createFromXaml("<GradientStop/>");t.offset=c.offset;t.color=_6.gfx.silverlight.hexColor(c.color);_f.gradientStops.add(t);});this._setFillAttr(_f);break;case "radial":this.fillStyle=f=_6.gfx.makeParameters(_6.gfx.defaultRadialGradient,_b);var rgb=p.createFromXaml("<RadialGradientBrush/>"),c=_6.gfx.matrix.multiplyPoint(_6.gfx.matrix.invert(this._getAdjustedMatrix()),f.cx,f.cy),pt=c.x+","+c.y;rgb.mappingMode="Absolute";rgb.gradientOrigin=pt;rgb.center=pt;rgb.radiusX=rgb.radiusY=f.r;_4.forEach(f.colors,function(c){var t=p.createFromXaml("<GradientStop/>");t.offset=c.offset;t.color=_6.gfx.silverlight.hexColor(c.color);rgb.gradientStops.add(t);});this._setFillAttr(rgb);break;case "pattern":this.fillStyle=null;this._setFillAttr(null);break;}return this;}this.fillStyle=f=_6.gfx.normalizeColor(_b);var scb=p.createFromXaml("<SolidColorBrush/>");scb.color=f.toHex();scb.opacity=f.a;this._setFillAttr(scb);return this;},_setFillAttr:function(f){this.rawNode.fill=f;},setStroke:function(_19){var p=this.rawNode.getHost().content,r=this.rawNode;if(!_19){this.strokeStyle=null;r.stroke=null;return this;}if(typeof _19=="string"||_4.isArray(_19)||_19 instanceof _4.Color){_19={color:_19};}var s=this.strokeStyle=_6.gfx.makeParameters(_6.gfx.defaultStroke,_19);s.color=_6.gfx.normalizeColor(s.color);if(s){var scb=p.createFromXaml("<SolidColorBrush/>");scb.color=s.color.toHex();scb.opacity=s.color.a;r.stroke=scb;r.strokeThickness=s.width;r.strokeStartLineCap=r.strokeEndLineCap=r.strokeDashCap=_6.gfx.silverlight.caps[s.cap];if(typeof s.join=="number"){r.strokeLineJoin="Miter";r.strokeMiterLimit=s.join;}else{r.strokeLineJoin=_6.gfx.silverlight.joins[s.join];}var da=s.style.toLowerCase();if(da in _6.gfx.silverlight.dasharray){da=_6.gfx.silverlight.dasharray[da];}if(da instanceof Array){da=_4.clone(da);if(s.cap!="butt"){for(var i=0;i<da.length;i+=2){--da[i];if(da[i]<1){da[i]=1;}}for(var i=1;i<da.length;i+=2){++da[i];}}r.strokeDashArray=da.join(",");}else{r.strokeDashArray=null;}}return this;},_getParentSurface:function(){var _20=this.parent;for(;_20&&!(_20 instanceof _6.gfx.Surface);_20=_20.parent){}return _20;},_applyTransform:function(){var tm=this._getAdjustedMatrix(),r=this.rawNode;if(tm){var p=this.rawNode.getHost().content,m=p.createFromXaml("<MatrixTransform/>"),mm=p.createFromXaml("<Matrix/>");mm.m11=tm.xx;mm.m21=tm.xy;mm.m12=tm.yx;mm.m22=tm.yy;mm.offsetX=tm.dx;mm.offsetY=tm.dy;m.matrix=mm;r.renderTransform=m;}else{r.renderTransform=null;}return this;},setRawNode:function(_26){_26.fill=null;_26.stroke=null;this.rawNode=_26;},_moveToFront:function(){var c=this.parent.rawNode.children,r=this.rawNode;c.remove(r);c.add(r);return this;},_moveToBack:function(){var c=this.parent.rawNode.children,r=this.rawNode;c.remove(r);c.insert(0,r);return this;},_getAdjustedMatrix:function(){return this.matrix;}});_4.declare("dojox.gfx.Group",_6.gfx.Shape,{constructor:function(){_6.gfx.silverlight.Container._init.call(this);},setRawNode:function(_2b){this.rawNode=_2b;}});_6.gfx.Group.nodeType="Canvas";_4.declare("dojox.gfx.Rect",_6.gfx.shape.Rect,{setShape:function(_2c){this.shape=_6.gfx.makeParameters(this.shape,_2c);this.bbox=null;var r=this.rawNode,n=this.shape;r.width=n.width;r.height=n.height;r.radiusX=r.radiusY=n.r;return this._applyTransform();},_getAdjustedMatrix:function(){var m=this.matrix,s=this.shape,d={dx:s.x,dy:s.y};return new _6.gfx.Matrix2D(m?[m,d]:d);}});_6.gfx.Rect.nodeType="Rectangle";_4.declare("dojox.gfx.Ellipse",_6.gfx.shape.Ellipse,{setShape:function(_32){this.shape=_6.gfx.makeParameters(this.shape,_32);this.bbox=null;var r=this.rawNode,n=this.shape;r.width=2*n.rx;r.height=2*n.ry;return this._applyTransform();},_getAdjustedMatrix:function(){var m=this.matrix,s=this.shape,d={dx:s.cx-s.rx,dy:s.cy-s.ry};return new _6.gfx.Matrix2D(m?[m,d]:d);}});_6.gfx.Ellipse.nodeType="Ellipse";_4.declare("dojox.gfx.Circle",_6.gfx.shape.Circle,{setShape:function(_38){this.shape=_6.gfx.makeParameters(this.shape,_38);this.bbox=null;var r=this.rawNode,n=this.shape;r.width=r.height=2*n.r;return this._applyTransform();},_getAdjustedMatrix:function(){var m=this.matrix,s=this.shape,d={dx:s.cx-s.r,dy:s.cy-s.r};return new _6.gfx.Matrix2D(m?[m,d]:d);}});_6.gfx.Circle.nodeType="Ellipse";_4.declare("dojox.gfx.Line",_6.gfx.shape.Line,{setShape:function(_3e){this.shape=_6.gfx.makeParameters(this.shape,_3e);this.bbox=null;var r=this.rawNode,n=this.shape;r.x1=n.x1;r.y1=n.y1;r.x2=n.x2;r.y2=n.y2;return this;}});_6.gfx.Line.nodeType="Line";_4.declare("dojox.gfx.Polyline",_6.gfx.shape.Polyline,{setShape:function(_41,_42){if(_41&&_41 instanceof Array){this.shape=_6.gfx.makeParameters(this.shape,{points:_41});if(_42&&this.shape.points.length){this.shape.points.push(this.shape.points[0]);}}else{this.shape=_6.gfx.makeParameters(this.shape,_41);}this.box=null;var p=this.shape.points,rp=[];for(var i=0;i<p.length;++i){if(typeof p[i]=="number"){rp.push(p[i],p[++i]);}else{rp.push(p[i].x,p[i].y);}}this.rawNode.points=rp.join(",");return this;}});_6.gfx.Polyline.nodeType="Polyline";_4.declare("dojox.gfx.Image",_6.gfx.shape.Image,{setShape:function(_46){this.shape=_6.gfx.makeParameters(this.shape,_46);this.bbox=null;var r=this.rawNode,n=this.shape;r.width=n.width;r.height=n.height;r.source=n.src;return this._applyTransform();},_getAdjustedMatrix:function(){var m=this.matrix,s=this.shape,d={dx:s.x,dy:s.y};return new _6.gfx.Matrix2D(m?[m,d]:d);},setRawNode:function(_4c){this.rawNode=_4c;}});_6.gfx.Image.nodeType="Image";_4.declare("dojox.gfx.Text",_6.gfx.shape.Text,{setShape:function(_4d){this.shape=_6.gfx.makeParameters(this.shape,_4d);this.bbox=null;var r=this.rawNode,s=this.shape;r.text=s.text;r.textDecorations=s.decoration==="underline"?"Underline":"None";r["Canvas.Left"]=-10000;r["Canvas.Top"]=-10000;if(!this._delay){this._delay=window.setTimeout(_4.hitch(this,"_delayAlignment"),10);}return this;},_delayAlignment:function(){var r=this.rawNode,s=this.shape,w=r.actualWidth,h=r.actualHeight,x=s.x,y=s.y-h*0.75;switch(s.align){case "middle":x-=w/2;break;case "end":x-=w;break;}this._delta={dx:x,dy:y};r["Canvas.Left"]=0;r["Canvas.Top"]=0;this._applyTransform();delete this._delay;},_getAdjustedMatrix:function(){var m=this.matrix,d=this._delta,x;if(m){x=d?[m,d]:m;}else{x=d?d:{};}return new _6.gfx.Matrix2D(x);},setStroke:function(){return this;},_setFillAttr:function(f){this.rawNode.foreground=f;},setRawNode:function(_5a){this.rawNode=_5a;},getTextWidth:function(){return this.rawNode.actualWidth;}});_6.gfx.Text.nodeType="TextBlock";_4.declare("dojox.gfx.Path",_6.gfx.path.Path,{_updateWithSegment:function(_5b){_6.gfx.Path.superclass._updateWithSegment.apply(this,arguments);var p=this.shape.path;if(typeof (p)=="string"){this.rawNode.data=p?p:null;}},setShape:function(_5d){_6.gfx.Path.superclass.setShape.apply(this,arguments);var p=this.shape.path;this.rawNode.data=p?p:null;return this;}});_6.gfx.Path.nodeType="Path";_4.declare("dojox.gfx.TextPath",_6.gfx.path.TextPath,{_updateWithSegment:function(_5f){},setShape:function(_60){},_setText:function(){}});_6.gfx.TextPath.nodeType="text";_6.gfx.silverlight.surfaces={};_6.gfx.silverlight.nullFunc=function(){};_4.declare("dojox.gfx.Surface",_6.gfx.shape.Surface,{constructor:function(){_6.gfx.silverlight.Container._init.call(this);},destroy:function(){window[this._onLoadName]=_6.gfx.silverlight.nullFunc;delete _6.gfx.silverlight.surfaces[this.rawNode.name];this.inherited(arguments);},setDimensions:function(_61,_62){this.width=_6.gfx.normalizedLength(_61);this.height=_6.gfx.normalizedLength(_62);var p=this.rawNode&&this.rawNode.getHost();if(p){p.width=_61;p.height=_62;}return this;},getDimensions:function(){var p=this.rawNode&&this.rawNode.getHost();var t=p?{width:p.content.actualWidth,height:p.content.actualHeight}:null;if(t.width<=0){t.width=this.width;}if(t.height<=0){t.height=this.height;}return t;}});_6.gfx.createSurface=function(_66,_67,_68){var s=new _6.gfx.Surface();_66=_4.byId(_66);s._parent=_66;var t=_66.ownerDocument.createElement("script");t.type="text/xaml";t.id=_6.gfx._base._getUniqueId();t.text="<?xml version='1.0'?><Canvas xmlns='http://schemas.microsoft.com/client/2007' Name='"+_6.gfx._base._getUniqueId()+"'/>";_66.parentNode.insertBefore(t,_66);s._nodes.push(t);var obj,_6c=_6.gfx._base._getUniqueId(),_6d="__"+_6.gfx._base._getUniqueId()+"_onLoad";s._onLoadName=_6d;window[_6d]=function(_6e){console.log("Silverlight: loaded");if(!s.rawNode){s.rawNode=_4.byId(_6c).content.root;_6.gfx.silverlight.surfaces[s.rawNode.name]=_66;s.onLoad(s);console.log("Silverlight: assigned");}};if(_4.isSafari){obj="<embed type='application/x-silverlight' id='"+_6c+"' width='"+_67+"' height='"+_68+" background='transparent'"+" source='#"+t.id+"'"+" windowless='true'"+" maxFramerate='60'"+" onLoad='"+_6d+"'"+" onError='__dojoSilverlightError'"+" /><iframe style='visibility:hidden;height:0;width:0'/>";}else{obj="<object type='application/x-silverlight' data='data:application/x-silverlight,' id='"+_6c+"' width='"+_67+"' height='"+_68+"'>"+"<param name='background' value='transparent' />"+"<param name='source' value='#"+t.id+"' />"+"<param name='windowless' value='true' />"+"<param name='maxFramerate' value='60' />"+"<param name='onLoad' value='"+_6d+"' />"+"<param name='onError' value='__dojoSilverlightError' />"+"</object>";}_66.innerHTML=obj;var _6f=_4.byId(_6c);if(_6f.content&&_6f.content.root){s.rawNode=_6f.content.root;_6.gfx.silverlight.surfaces[s.rawNode.name]=_66;}else{s.rawNode=null;s.isLoaded=false;}s._nodes.push(_6f);s.width=_6.gfx.normalizedLength(_67);s.height=_6.gfx.normalizedLength(_68);return s;};__dojoSilverlightError=function(_70,err){var t="Silverlight Error:\n"+"Code: "+err.ErrorCode+"\n"+"Type: "+err.ErrorType+"\n"+"Message: "+err.ErrorMessage+"\n";switch(err.ErrorType){case "ParserError":t+="XamlFile: "+err.xamlFile+"\n"+"Line: "+err.lineNumber+"\n"+"Position: "+err.charPosition+"\n";break;case "RuntimeError":t+="MethodName: "+err.methodName+"\n";if(err.lineNumber!=0){t+="Line: "+err.lineNumber+"\n"+"Position: "+err.charPosition+"\n";}break;}console.error(t);};_6.gfx.silverlight.Font={_setFont:function(){var f=this.fontStyle,r=this.rawNode,fw=_6.gfx.silverlight.fontweight,fo=_6.gfx.silverlight.fonts,t=f.family.toLowerCase();r.fontStyle=f.style=="italic"?"Italic":"Normal";r.fontWeight=f.weight in fw?fw[f.weight]:f.weight;r.fontSize=_6.gfx.normalizedLength(f.size);r.fontFamily=t in fo?fo[t]:f.family;if(!this._delay){this._delay=window.setTimeout(_4.hitch(this,"_delayAlignment"),10);}}};_6.gfx.silverlight.Container={_init:function(){_6.gfx.shape.Container._init.call(this);},add:function(_78){if(this!=_78.getParent()){_6.gfx.shape.Container.add.apply(this,arguments);this.rawNode.children.add(_78.rawNode);}return this;},remove:function(_79,_7a){if(this==_79.getParent()){var _7b=_79.rawNode.getParent();if(_7b){_7b.children.remove(_79.rawNode);}_6.gfx.shape.Container.remove.apply(this,arguments);}return this;},clear:function(){this.rawNode.children.clear();return _6.gfx.shape.Container.clear.apply(this,arguments);},_moveChildToFront:_6.gfx.shape.Container._moveChildToFront,_moveChildToBack:_6.gfx.shape.Container._moveChildToBack};_4.mixin(_6.gfx.shape.Creator,{createObject:function(_7c,_7d){if(!this.rawNode){return null;}var _7e=new _7c();var _7f=this.rawNode.getHost().content.createFromXaml("<"+_7c.nodeType+"/>");_7e.setRawNode(_7f);_7e.setShape(_7d);this.add(_7e);return _7e;}});_4.extend(_6.gfx.Text,_6.gfx.silverlight.Font);_4.extend(_6.gfx.Group,_6.gfx.silverlight.Container);_4.extend(_6.gfx.Group,_6.gfx.shape.Creator);_4.extend(_6.gfx.Surface,_6.gfx.silverlight.Container);_4.extend(_6.gfx.Surface,_6.gfx.shape.Creator);(function(){var _80=_6.gfx.silverlight.surfaces;var _81=function(s,a){var ev={target:s,currentTarget:s,preventDefault:function(){},stopPropagation:function(){}};if(a){try{ev.ctrlKey=a.ctrl;ev.shiftKey=a.shift;var p=a.getPosition(null);ev.x=ev.offsetX=ev.layerX=p.x;ev.y=ev.offsetY=ev.layerY=p.y;var _86=_80[s.getHost().content.root.name];var t=_4._abs(_86);ev.clientX=t.x+p.x;ev.clientY=t.y+p.y;}catch(e){}}return ev;};var _88=function(s,a){var ev={keyCode:a.platformKeyCode,ctrlKey:a.ctrl,shiftKey:a.shift};return ev;};var _8c={onclick:{name:"MouseLeftButtonUp",fix:_81},onmouseenter:{name:"MouseEnter",fix:_81},onmouseleave:{name:"MouseLeave",fix:_81},onmouseover:{name:"MouseEnter",fix:_81},onmouseout:{name:"MouseLeave",fix:_81},onmousedown:{name:"MouseLeftButtonDown",fix:_81},onmouseup:{name:"MouseLeftButtonUp",fix:_81},onmousemove:{name:"MouseMove",fix:_81},onkeydown:{name:"KeyDown",fix:_88},onkeyup:{name:"KeyUp",fix:_88}};var _8d={connect:function(_8e,_8f,_90){var _91,n=_8e in _8c?_8c[_8e]:{name:_8e,fix:function(){return {};}};if(arguments.length>2){_91=this.getEventSource().addEventListener(n.name,function(s,a){_4.hitch(_8f,_90)(n.fix(s,a));});}else{_91=this.getEventSource().addEventListener(n.name,function(s,a){_8f(n.fix(s,a));});}return {name:n.name,token:_91};},disconnect:function(_97){this.getEventSource().removeEventListener(_97.name,_97.token);}};_4.extend(_6.gfx.Shape,_8d);_4.extend(_6.gfx.Surface,_8d);_6.gfx.equalSources=function(a,b){return a&&b&&a.equals(b);};})();}}};});