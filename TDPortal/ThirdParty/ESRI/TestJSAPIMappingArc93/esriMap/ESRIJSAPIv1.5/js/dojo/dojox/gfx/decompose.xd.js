/*
	Copyright (c) 2004-2009, The Dojo Foundation All Rights Reserved.
	Available via Academic Free License >= 2.1 OR the modified BSD license.
	see: http://dojotoolkit.org/license for details
*/


dojo._xdResourceLoaded(function(_1,_2,_3){return {depends:[["provide","dojox.gfx.decompose"],["require","dojox.gfx.matrix"]],defineResource:function(_4,_5,_6){if(!_4._hasResource["dojox.gfx.decompose"]){_4._hasResource["dojox.gfx.decompose"]=true;_4.provide("dojox.gfx.decompose");_4.require("dojox.gfx.matrix");(function(){var m=_6.gfx.matrix;var eq=function(a,b){return Math.abs(a-b)<=0.000001*(Math.abs(a)+Math.abs(b));};var _b=function(r1,m1,r2,m2){if(!isFinite(r1)){return r2;}else{if(!isFinite(r2)){return r1;}}m1=Math.abs(m1),m2=Math.abs(m2);return (m1*r1+m2*r2)/(m1+m2);};var _10=function(_11){var M=new m.Matrix2D(_11);return _4.mixin(M,{dx:0,dy:0,xy:M.yx,yx:M.xy});};var _13=function(_14){return (_14.xx*_14.yy<0||_14.xy*_14.yx>0)?-1:1;};var _15=function(_16){var M=m.normalize(_16),b=-M.xx-M.yy,c=M.xx*M.yy-M.xy*M.yx,d=Math.sqrt(b*b-4*c),l1=-(b+(b<0?-d:d))/2,l2=c/l1,vx1=M.xy/(l1-M.xx),vy1=1,vx2=M.xy/(l2-M.xx),vy2=1;if(eq(l1,l2)){vx1=1,vy1=0,vx2=0,vy2=1;}if(!isFinite(vx1)){vx1=1,vy1=(l1-M.xx)/M.xy;if(!isFinite(vy1)){vx1=(l1-M.yy)/M.yx,vy1=1;if(!isFinite(vx1)){vx1=1,vy1=M.yx/(l1-M.yy);}}}if(!isFinite(vx2)){vx2=1,vy2=(l2-M.xx)/M.xy;if(!isFinite(vy2)){vx2=(l2-M.yy)/M.yx,vy2=1;if(!isFinite(vx2)){vx2=1,vy2=M.yx/(l2-M.yy);}}}var d1=Math.sqrt(vx1*vx1+vy1*vy1),d2=Math.sqrt(vx2*vx2+vy2*vy2);if(!isFinite(vx1/=d1)){vx1=0;}if(!isFinite(vy1/=d1)){vy1=0;}if(!isFinite(vx2/=d2)){vx2=0;}if(!isFinite(vy2/=d2)){vy2=0;}return {value1:l1,value2:l2,vector1:{x:vx1,y:vy1},vector2:{x:vx2,y:vy2}};};var _23=function(M,_25){var _26=_13(M),a=_25.angle1=(Math.atan2(M.yx,M.yy)+Math.atan2(-_26*M.xy,_26*M.xx))/2,cos=Math.cos(a),sin=Math.sin(a);_25.sx=_b(M.xx/cos,cos,-M.xy/sin,sin);_25.sy=_b(M.yy/cos,cos,M.yx/sin,sin);return _25;};var _2a=function(M,_2c){var _2d=_13(M),a=_2c.angle2=(Math.atan2(_2d*M.yx,_2d*M.xx)+Math.atan2(-M.xy,M.yy))/2,cos=Math.cos(a),sin=Math.sin(a);_2c.sx=_b(M.xx/cos,cos,M.yx/sin,sin);_2c.sy=_b(M.yy/cos,cos,-M.xy/sin,sin);return _2c;};_6.gfx.decompose=function(_31){var M=m.normalize(_31),_33={dx:M.dx,dy:M.dy,sx:1,sy:1,angle1:0,angle2:0};if(eq(M.xy,0)&&eq(M.yx,0)){return _4.mixin(_33,{sx:M.xx,sy:M.yy});}if(eq(M.xx*M.yx,-M.xy*M.yy)){return _23(M,_33);}if(eq(M.xx*M.xy,-M.yx*M.yy)){return _2a(M,_33);}var MT=_10(M),u=_15([M,MT]),v=_15([MT,M]),U=new m.Matrix2D({xx:u.vector1.x,xy:u.vector2.x,yx:u.vector1.y,yy:u.vector2.y}),VT=new m.Matrix2D({xx:v.vector1.x,xy:v.vector1.y,yx:v.vector2.x,yy:v.vector2.y}),S=new m.Matrix2D([m.invert(U),M,m.invert(VT)]);_23(VT,_33);S.xx*=_33.sx;S.yy*=_33.sy;_2a(U,_33);S.xx*=_33.sx;S.yy*=_33.sy;return _4.mixin(_33,{sx:S.xx,sy:S.yy});};})();}}};});