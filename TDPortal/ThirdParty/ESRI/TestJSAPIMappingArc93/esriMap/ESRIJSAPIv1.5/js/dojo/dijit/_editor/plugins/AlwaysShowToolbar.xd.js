/*
	Copyright (c) 2004-2009, The Dojo Foundation All Rights Reserved.
	Available via Academic Free License >= 2.1 OR the modified BSD license.
	see: http://dojotoolkit.org/license for details
*/


dojo._xdResourceLoaded(function(_1,_2,_3){return {depends:[["provide","dijit._editor.plugins.AlwaysShowToolbar"]],defineResource:function(_4,_5,_6){if(!_4._hasResource["dijit._editor.plugins.AlwaysShowToolbar"]){_4._hasResource["dijit._editor.plugins.AlwaysShowToolbar"]=true;_4.provide("dijit._editor.plugins.AlwaysShowToolbar");_4.declare("dijit._editor.plugins.AlwaysShowToolbar",_5._editor._Plugin,{_handleScroll:true,setEditor:function(e){if(!e.iframe){console.log("Port AlwaysShowToolbar plugin to work with Editor without iframe");return;}this.editor=e;e.onLoadDeferred.addCallback(_4.hitch(this,this.enable));},enable:function(d){this._updateHeight();this.connect(window,"onscroll","globalOnScrollHandler");this.connect(this.editor,"onNormalizedDisplayChanged","_updateHeight");return d;},_updateHeight:function(){var e=this.editor;if(!e.isLoaded){return;}if(e.height){return;}var _a=_4.marginBox(e.editNode).h;if(_4.isOpera){_a=e.editNode.scrollHeight;}if(!_a){_a=_4.marginBox(e.document.body).h;}if(_a==0){console.debug("Can not figure out the height of the editing area!");return;}if(_4.isIE<=7&&this.editor.minHeight){var _b=parseInt(this.editor.minHeight);if(_a<_b){_a=_b;}}if(_a!=this._lastHeight){this._lastHeight=_a;_4.marginBox(e.iframe,{h:this._lastHeight});}},_lastHeight:0,globalOnScrollHandler:function(){var _c=_4.isIE<7;if(!this._handleScroll){return;}var _d=this.editor.toolbar.domNode;var db=_4.body;if(!this._scrollSetUp){this._scrollSetUp=true;this._scrollThreshold=_4._abs(_d,true).y;}var _f=_4._docScroll().y;var s=_d.style;if(_f>this._scrollThreshold&&_f<this._scrollThreshold+this._lastHeight){if(!this._fixEnabled){var _11=_4.marginBox(_d);this.editor.iframe.style.marginTop=_11.h+"px";if(_c){s.left=_4._abs(_d).x;if(_d.previousSibling){this._IEOriginalPos=["after",_d.previousSibling];}else{if(_d.nextSibling){this._IEOriginalPos=["before",_d.nextSibling];}else{this._IEOriginalPos=["last",_d.parentNode];}}_4.body().appendChild(_d);_4.addClass(_d,"dijitIEFixedToolbar");}else{s.position="fixed";s.top="0px";}_4.marginBox(_d,{w:_11.w});s.zIndex=2000;this._fixEnabled=true;}var _12=(this.height)?parseInt(this.editor.height):this.editor._lastHeight;s.display=(_f>this._scrollThreshold+_12)?"none":"";}else{if(this._fixEnabled){this.editor.iframe.style.marginTop="";s.position="";s.top="";s.zIndex="";s.display="";if(_c){s.left="";_4.removeClass(_d,"dijitIEFixedToolbar");if(this._IEOriginalPos){_4.place(_d,this._IEOriginalPos[1],this._IEOriginalPos[0]);this._IEOriginalPos=null;}else{_4.place(_d,this.editor.iframe,"before");}}s.width="";this._fixEnabled=false;}}},destroy:function(){this._IEOriginalPos=null;this._handleScroll=false;_4.forEach(this._connects,_4.disconnect);if(_4.isIE<7){_4.removeClass(this.editor.toolbar.domNode,"dijitIEFixedToolbar");}}});}}};});