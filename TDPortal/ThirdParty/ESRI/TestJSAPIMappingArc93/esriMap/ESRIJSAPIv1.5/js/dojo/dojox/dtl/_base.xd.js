/*
	Copyright (c) 2004-2009, The Dojo Foundation All Rights Reserved.
	Available via Academic Free License >= 2.1 OR the modified BSD license.
	see: http://dojotoolkit.org/license for details
*/


dojo._xdResourceLoaded(function(_1,_2,_3){return {depends:[["provide","dojox.dtl._base"],["require","dojox.string.Builder"],["require","dojox.string.tokenize"],["require","dojox.string.Builder"]],defineResource:function(_4,_5,_6){if(!_4._hasResource["dojox.dtl._base"]){_4._hasResource["dojox.dtl._base"]=true;_4.provide("dojox.dtl._base");_4.require("dojox.string.Builder");_4.require("dojox.string.tokenize");_4.experimental("dojox.dtl");(function(){var dd=_6.dtl;dd.TOKEN_BLOCK=-1;dd.TOKEN_VAR=-2;dd.TOKEN_COMMENT=-3;dd.TOKEN_TEXT=3;dd._Context=_4.extend(function(_8){_4._mixin(this,_8||{});this._dicts=[];},{push:function(){var _9=this;var _a=_4.delegate(this);_a.pop=function(){return _9;};return _a;},pop:function(){throw new Error("pop() called on empty Context");},get:function(_b,_c){if(typeof this[_b]!="undefined"){return this._normalize(this[_b]);}for(var i=0,_e;_e=this._dicts[i];i++){if(typeof _e[_b]!="undefined"){return this._normalize(_e[_b]);}}return _c;},_normalize:function(_f){if(_f instanceof Date){_f.year=_f.getFullYear();_f.month=_f.getMonth()+1;_f.day=_f.getDate();_f.date=_f.year+"-"+("0"+_f.month).slice(-2)+"-"+("0"+_f.day).slice(-2);_f.hour=_f.getHours();_f.minute=_f.getMinutes();_f.second=_f.getSeconds();_f.microsecond=_f.getMilliseconds();}return _f;},update:function(_10){var _11=this.push();if(_10){_4._mixin(this,_10);}return _11;}});var _12=/("(?:[^"\\]*(?:\\.[^"\\]*)*)"|'(?:[^'\\]*(?:\\.[^'\\]*)*)'|[^\s]+)/g;var _13=/\s+/g;var _14=function(_15,_16){_15=_15||_13;if(!(_15 instanceof RegExp)){_15=new RegExp(_15,"g");}if(!_15.global){throw new Error("You must use a globally flagged RegExp with split "+_15);}_15.exec("");var _17,_18=[],_19=0,i=0;while(_17=_15.exec(this)){_18.push(this.slice(_19,_15.lastIndex-_17[0].length));_19=_15.lastIndex;if(_16&&(++i>_16-1)){break;}}_18.push(this.slice(_19));return _18;};dd.Token=function(_1b,_1c){this.token_type=_1b;this.contents=new String(_4.trim(_1c));this.contents.split=_14;this.split=function(){return String.prototype.split.apply(this.contents,arguments);};};dd.Token.prototype.split_contents=function(_1d){var bit,_1f=[],i=0;_1d=_1d||999;while(i++<_1d&&(bit=_12.exec(this.contents))){bit=bit[0];if(bit.charAt(0)=="\""&&bit.slice(-1)=="\""){_1f.push("\""+bit.slice(1,-1).replace("\\\"","\"").replace("\\\\","\\")+"\"");}else{if(bit.charAt(0)=="'"&&bit.slice(-1)=="'"){_1f.push("'"+bit.slice(1,-1).replace("\\'","'").replace("\\\\","\\")+"'");}else{_1f.push(bit);}}}return _1f;};var ddt=dd.text={_get:function(_22,_23,_24){var _25=dd.register.get(_22,_23.toLowerCase(),_24);if(!_25){if(!_24){throw new Error("No tag found for "+_23);}return null;}var fn=_25[1];var _27=_25[2];var _28;if(fn.indexOf(":")!=-1){_28=fn.split(":");fn=_28.pop();}_4["require"](_27);var _29=_4.getObject(_27);return _29[fn||_23]||_29[_23+"_"]||_29[fn+"_"];},getTag:function(_2a,_2b){return ddt._get("tag",_2a,_2b);},getFilter:function(_2c,_2d){return ddt._get("filter",_2c,_2d);},getTemplate:function(_2e){return new dd.Template(ddt.getTemplateString(_2e));},getTemplateString:function(_2f){return _4._getText(_2f.toString())||"";},_resolveLazy:function(_30,_31,_32){if(_31){if(_32){return _4.fromJson(_4._getText(_30))||{};}else{return dd.text.getTemplateString(_30);}}else{return _4.xhrGet({handleAs:(_32)?"json":"text",url:_30});}},_resolveTemplateArg:function(arg,_34){if(ddt._isTemplate(arg)){if(!_34){var d=new _4.Deferred();d.callback(arg);return d;}return arg;}return ddt._resolveLazy(arg,_34);},_isTemplate:function(arg){return (typeof arg=="undefined")||(typeof arg=="string"&&(arg.match(/^\s*[<{]/)||arg.indexOf(" ")!=-1));},_resolveContextArg:function(arg,_38){if(arg.constructor==Object){if(!_38){var d=new _4.Deferred;d.callback(arg);return d;}return arg;}return ddt._resolveLazy(arg,_38,true);},_re:/(?:\{\{\s*(.+?)\s*\}\}|\{%\s*(load\s*)?(.+?)\s*%\})/g,tokenize:function(str){return _6.string.tokenize(str,ddt._re,ddt._parseDelims);},_parseDelims:function(_3b,_3c,tag){if(_3b){return [dd.TOKEN_VAR,_3b];}else{if(_3c){var _3e=_4.trim(tag).split(/\s+/g);for(var i=0,_40;_40=_3e[i];i++){_4["require"](_40);}}else{return [dd.TOKEN_BLOCK,tag];}}}};dd.Template=_4.extend(function(_41,_42){var str=_42?_41:ddt._resolveTemplateArg(_41,true)||"";var _44=ddt.tokenize(str);var _45=new dd._Parser(_44);this.nodelist=_45.parse();},{update:function(_46,_47){return ddt._resolveContextArg(_47).addCallback(this,function(_48){var _49=this.render(new dd._Context(_48));if(_46.forEach){_46.forEach(function(_4a){_4a.innerHTML=_49;});}else{_4.byId(_46).innerHTML=_49;}return this;});},render:function(_4b,_4c){_4c=_4c||this.getBuffer();_4b=_4b||new dd._Context({});return this.nodelist.render(_4b,_4c)+"";},getBuffer:function(){_4.require("dojox.string.Builder");return new _6.string.Builder();}});var _4d=/\{\{\s*(.+?)\s*\}\}/g;dd.quickFilter=function(str){if(!str){return new dd._NodeList();}if(str.indexOf("{%")==-1){return new dd._QuickNodeList(_6.string.tokenize(str,_4d,function(_4f){return new dd._Filter(_4f);}));}};dd._QuickNodeList=_4.extend(function(_50){this.contents=_50;},{render:function(_51,_52){for(var i=0,l=this.contents.length;i<l;i++){if(this.contents[i].resolve){_52=_52.concat(this.contents[i].resolve(_51));}else{_52=_52.concat(this.contents[i]);}}return _52;},dummyRender:function(_55){return this.render(_55,dd.Template.prototype.getBuffer()).toString();},clone:function(_56){return this;}});dd._Filter=_4.extend(function(_57){if(!_57){throw new Error("Filter must be called with variable name");}this.contents=_57;var _58=this._cache[_57];if(_58){this.key=_58[0];this.filters=_58[1];}else{this.filters=[];_6.string.tokenize(_57,this._re,this._tokenize,this);this._cache[_57]=[this.key,this.filters];}},{_cache:{},_re:/(?:^_\("([^\\"]*(?:\\.[^\\"])*)"\)|^"([^\\"]*(?:\\.[^\\"]*)*)"|^([a-zA-Z0-9_.]+)|\|(\w+)(?::(?:_\("([^\\"]*(?:\\.[^\\"])*)"\)|"([^\\"]*(?:\\.[^\\"]*)*)"|([a-zA-Z0-9_.]+)|'([^\\']*(?:\\.[^\\']*)*)'))?|^'([^\\']*(?:\\.[^\\']*)*)')/g,_values:{0:"\"",1:"\"",2:"",8:"\""},_args:{4:"\"",5:"\"",6:"",7:"'"},_tokenize:function(){var pos,arg;for(var i=0,has=[];i<arguments.length;i++){has[i]=(typeof arguments[i]!="undefined"&&typeof arguments[i]=="string"&&arguments[i]);}if(!this.key){for(pos in this._values){if(has[pos]){this.key=this._values[pos]+arguments[pos]+this._values[pos];break;}}}else{for(pos in this._args){if(has[pos]){var _5d=arguments[pos];if(this._args[pos]=="'"){_5d=_5d.replace(/\\'/g,"'");}else{if(this._args[pos]=="\""){_5d=_5d.replace(/\\"/g,"\"");}}arg=[!this._args[pos],_5d];break;}}var fn=ddt.getFilter(arguments[3]);if(!_4.isFunction(fn)){throw new Error(arguments[3]+" is not registered as a filter");}this.filters.push([fn,arg]);}},getExpression:function(){return this.contents;},resolve:function(_5f){if(typeof this.key=="undefined"){return "";}var str=this.resolvePath(this.key,_5f);for(var i=0,_62;_62=this.filters[i];i++){if(_62[1]){if(_62[1][0]){str=_62[0](str,this.resolvePath(_62[1][1],_5f));}else{str=_62[0](str,_62[1][1]);}}else{str=_62[0](str);}}return str;},resolvePath:function(_63,_64){var _65,_66;var _67=_63.charAt(0);var _68=_63.slice(-1);if(!isNaN(parseInt(_67))){_65=(_63.indexOf(".")==-1)?parseInt(_63):parseFloat(_63);}else{if(_67=="\""&&_67==_68){_65=_63.slice(1,-1);}else{if(_63=="true"){return true;}if(_63=="false"){return false;}if(_63=="null"||_63=="None"){return null;}_66=_63.split(".");_65=_64.get(_66[0]);if(_4.isFunction(_65)){var _69=_64.getThis&&_64.getThis();if(_65.alters_data){_65="";}else{if(_69){_65=_65.call(_69);}else{_65="";}}}for(var i=1;i<_66.length;i++){var _6b=_66[i];if(_65){var _6c=_65;if(_4.isObject(_65)&&_6b=="items"&&typeof _65[_6b]=="undefined"){var _6d=[];for(var key in _65){_6d.push([key,_65[key]]);}_65=_6d;continue;}if(_65.get&&_4.isFunction(_65.get)&&_65.get.safe){_65=_65.get(_6b);}else{if(typeof _65[_6b]=="undefined"){_65=_65[_6b];break;}else{_65=_65[_6b];}}if(_4.isFunction(_65)){if(_65.alters_data){_65="";}else{_65=_65.call(_6c);}}else{if(_65 instanceof Date){_65=dd._Context.prototype._normalize(_65);}}}else{return "";}}}}return _65;}});dd._TextNode=dd._Node=_4.extend(function(obj){this.contents=obj;},{set:function(_70){this.contents=_70;return this;},render:function(_71,_72){return _72.concat(this.contents);},isEmpty:function(){return !_4.trim(this.contents);},clone:function(){return this;}});dd._NodeList=_4.extend(function(_73){this.contents=_73||[];this.last="";},{push:function(_74){this.contents.push(_74);return this;},concat:function(_75){this.contents=this.contents.concat(_75);return this;},render:function(_76,_77){for(var i=0;i<this.contents.length;i++){_77=this.contents[i].render(_76,_77);if(!_77){throw new Error("Template must return buffer");}}return _77;},dummyRender:function(_79){return this.render(_79,dd.Template.prototype.getBuffer()).toString();},unrender:function(){return arguments[1];},clone:function(){return this;},rtrim:function(){while(1){i=this.contents.length-1;if(this.contents[i] instanceof dd._TextNode&&this.contents[i].isEmpty()){this.contents.pop();}else{break;}}return this;}});dd._VarNode=_4.extend(function(str){this.contents=new dd._Filter(str);},{render:function(_7b,_7c){var str=this.contents.resolve(_7b);if(!str.safe){str=dd._base.escape(""+str);}return _7c.concat(str);}});dd._noOpNode=new function(){this.render=this.unrender=function(){return arguments[1];};this.clone=function(){return this;};};dd._Parser=_4.extend(function(_7e){this.contents=_7e;},{i:0,parse:function(_7f){var _80={};_7f=_7f||[];for(var i=0;i<_7f.length;i++){_80[_7f[i]]=true;}var _82=new dd._NodeList();while(this.i<this.contents.length){token=this.contents[this.i++];if(typeof token=="string"){_82.push(new dd._TextNode(token));}else{var _83=token[0];var _84=token[1];if(_83==dd.TOKEN_VAR){_82.push(new dd._VarNode(_84));}else{if(_83==dd.TOKEN_BLOCK){if(_80[_84]){--this.i;return _82;}var cmd=_84.split(/\s+/g);if(cmd.length){cmd=cmd[0];var fn=ddt.getTag(cmd);if(fn){_82.push(fn(this,new dd.Token(_83,_84)));}}}}}}if(_7f.length){throw new Error("Could not find closing tag(s): "+_7f.toString());}this.contents.length=0;return _82;},next_token:function(){var _87=this.contents[this.i++];return new dd.Token(_87[0],_87[1]);},delete_first_token:function(){this.i++;},skip_past:function(_88){while(this.i<this.contents.length){var _89=this.contents[this.i++];if(_89[0]==dd.TOKEN_BLOCK&&_89[1]==_88){return;}}throw new Error("Unclosed tag found when looking for "+_88);},create_variable_node:function(_8a){return new dd._VarNode(_8a);},create_text_node:function(_8b){return new dd._TextNode(_8b||"");},getTemplate:function(_8c){return new dd.Template(_8c);}});dd.register={_registry:{attributes:[],tags:[],filters:[]},get:function(_8d,_8e){var _8f=dd.register._registry[_8d+"s"];for(var i=0,_91;_91=_8f[i];i++){if(typeof _91[0]=="string"){if(_91[0]==_8e){return _91;}}else{if(_8e.match(_91[0])){return _91;}}}},getAttributeTags:function(){var _92=[];var _93=dd.register._registry.attributes;for(var i=0,_95;_95=_93[i];i++){if(_95.length==3){_92.push(_95);}else{var fn=_4.getObject(_95[1]);if(fn&&_4.isFunction(fn)){_95.push(fn);_92.push(_95);}}}return _92;},_any:function(_97,_98,_99){for(var _9a in _99){for(var i=0,fn;fn=_99[_9a][i];i++){var key=fn;if(_4.isArray(fn)){key=fn[0];fn=fn[1];}if(typeof key=="string"){if(key.substr(0,5)=="attr:"){var _9e=fn;if(_9e.substr(0,5)=="attr:"){_9e=_9e.slice(5);}dd.register._registry.attributes.push([_9e.toLowerCase(),_98+"."+_9a+"."+_9e]);}key=key.toLowerCase();}dd.register._registry[_97].push([key,fn,_98+"."+_9a]);}}},tags:function(_9f,_a0){dd.register._any("tags",_9f,_a0);},filters:function(_a1,_a2){dd.register._any("filters",_a1,_a2);}};var _a3=/&/g;var _a4=/</g;var _a5=/>/g;var _a6=/'/g;var _a7=/"/g;dd._base.escape=function(_a8){return dd.mark_safe(_a8.replace(_a3,"&amp;").replace(_a4,"&lt;").replace(_a5,"&gt;").replace(_a7,"&quot;").replace(_a6,"&#39;"));};dd._base.safe=function(_a9){if(typeof _a9=="string"){_a9=new String(_a9);}if(typeof _a9=="object"){_a9.safe=true;}return _a9;};dd.mark_safe=dd._base.safe;dd.register.tags("dojox.dtl.tag",{"date":["now"],"logic":["if","for","ifequal","ifnotequal"],"loader":["extends","block","include","load","ssi"],"misc":["comment","debug","filter","firstof","spaceless","templatetag","widthratio","with"],"loop":["cycle","ifchanged","regroup"]});dd.register.filters("dojox.dtl.filter",{"dates":["date","time","timesince","timeuntil"],"htmlstrings":["linebreaks","linebreaksbr","removetags","striptags"],"integers":["add","get_digit"],"lists":["dictsort","dictsortreversed","first","join","length","length_is","random","slice","unordered_list"],"logic":["default","default_if_none","divisibleby","yesno"],"misc":["filesizeformat","pluralize","phone2numeric","pprint"],"strings":["addslashes","capfirst","center","cut","fix_ampersands","floatformat","iriencode","linenumbers","ljust","lower","make_list","rjust","slugify","stringformat","title","truncatewords","truncatewords_html","upper","urlencode","urlize","urlizetrunc","wordcount","wordwrap"]});dd.register.filters("dojox.dtl",{"_base":["escape","safe"]});})();}}};});