/*
	Copyright (c) 2004-2009, The Dojo Foundation All Rights Reserved.
	Available via Academic Free License >= 2.1 OR the modified BSD license.
	see: http://dojotoolkit.org/license for details
*/


dojo._xdResourceLoaded(function(_1,_2,_3){return {depends:[["provide","dojox.grid.compat._grid.view"],["require","dijit._Widget"],["require","dijit._Templated"],["require","dojox.grid.compat._grid.builder"]],defineResource:function(_4,_5,_6){if(!_4._hasResource["dojox.grid.compat._grid.view"]){_4._hasResource["dojox.grid.compat._grid.view"]=true;_4.provide("dojox.grid.compat._grid.view");_4.require("dijit._Widget");_4.require("dijit._Templated");_4.require("dojox.grid.compat._grid.builder");_4.declare("dojox.GridView",[_5._Widget,_5._Templated],{defaultWidth:"18em",viewWidth:"",templateString:"<div class=\"dojoxGrid-view\">\r\n\t<div class=\"dojoxGrid-header\" dojoAttachPoint=\"headerNode\">\r\n\t\t<div dojoAttachPoint=\"headerNodeContainer\" style=\"width:9000em\">\r\n\t\t\t<div dojoAttachPoint=\"headerContentNode\"></div>\r\n\t\t</div>\r\n\t</div>\r\n\t<input type=\"checkbox\" class=\"dojoxGrid-hidden-focus\" dojoAttachPoint=\"hiddenFocusNode\" />\r\n\t<input type=\"checkbox\" class=\"dojoxGrid-hidden-focus\" />\r\n\t<div class=\"dojoxGrid-scrollbox\" dojoAttachPoint=\"scrollboxNode\">\r\n\t\t<div class=\"dojoxGrid-content\" dojoAttachPoint=\"contentNode\" hidefocus=\"hidefocus\"></div>\r\n\t</div>\r\n</div>\r\n",themeable:false,classTag:"dojoxGrid",marginBottom:0,rowPad:2,postMixInProperties:function(){this.rowNodes=[];},postCreate:function(){this.connect(this.scrollboxNode,"onscroll","doscroll");_6.grid.funnelEvents(this.contentNode,this,"doContentEvent",["mouseover","mouseout","click","dblclick","contextmenu","mousedown"]);_6.grid.funnelEvents(this.headerNode,this,"doHeaderEvent",["dblclick","mouseover","mouseout","mousemove","mousedown","click","contextmenu"]);this.content=new _6.grid.contentBuilder(this);this.header=new _6.grid.headerBuilder(this);if(!_4._isBodyLtr()){this.headerNodeContainer.style.width="";}},destroy:function(){_6.grid.removeNode(this.headerNode);this.inherited("destroy",arguments);},focus:function(){if(_4.isWebKit||_4.isOpera){this.hiddenFocusNode.focus();}else{this.scrollboxNode.focus();}},setStructure:function(_7){var vs=(this.structure=_7);if(vs.width&&!isNaN(vs.width)){this.viewWidth=vs.width+"em";}else{this.viewWidth=vs.width||this.viewWidth;}this.onBeforeRow=vs.onBeforeRow;this.noscroll=vs.noscroll;if(this.noscroll){this.scrollboxNode.style.overflow="hidden";}this.testFlexCells();this.updateStructure();},testFlexCells:function(){this.flexCells=false;for(var j=0,_a;(_a=this.structure.rows[j]);j++){for(var i=0,_c;(_c=_a[i]);i++){_c.view=this;this.flexCells=this.flexCells||_c.isFlex();}}return this.flexCells;},updateStructure:function(){this.header.update();this.content.update();},getScrollbarWidth:function(){return (this.noscroll?0:_6.grid.getScrollbarWidth());},getColumnsWidth:function(){return this.headerContentNode.firstChild.offsetWidth;},getWidth:function(){return this.viewWidth||(this.getColumnsWidth()+this.getScrollbarWidth())+"px";},getContentWidth:function(){return Math.max(0,_4._getContentBox(this.domNode).w-this.getScrollbarWidth())+"px";},render:function(){this.scrollboxNode.style.height="";this.renderHeader();},renderHeader:function(){this.headerContentNode.innerHTML=this.header.generateHtml(this._getHeaderContent);},_getHeaderContent:function(_d){var n=_d.name||_d.grid.getCellName(_d);if(_d.index!=_d.grid.getSortIndex()){return n;}return ["<div class=\"",_d.grid.sortInfo>0?"dojoxGrid-sort-down":"dojoxGrid-sort-up","\"><div class=\"gridArrowButtonChar\">",_d.grid.sortInfo>0?"&#9660;":"&#9650;","</div>",n,"</div>"].join("");},resize:function(){this.adaptHeight();this.adaptWidth();},hasScrollbar:function(){return (this.scrollboxNode.clientHeight!=this.scrollboxNode.offsetHeight);},adaptHeight:function(){if(!this.grid.autoHeight){var h=this.domNode.clientHeight;if(!this.hasScrollbar()){h-=_6.grid.getScrollbarWidth();}_6.grid.setStyleHeightPx(this.scrollboxNode,h);}},adaptWidth:function(){if(this.flexCells){this.contentWidth=this.getContentWidth();this.headerContentNode.firstChild.style.width=this.contentWidth;}var w=this.scrollboxNode.offsetWidth-this.getScrollbarWidth();w=Math.max(w,this.getColumnsWidth())+"px";with(this.contentNode){style.width="";offsetWidth;style.width=w;}},setSize:function(w,h){with(this.domNode.style){if(w){width=w;}height=(h>=0?h+"px":"");}with(this.headerNode.style){if(w){width=w;}}},renderRow:function(_13,_14){var _15=this.createRowNode(_13);this.buildRow(_13,_15,_14);this.grid.edit.restore(this,_13);return _15;},createRowNode:function(_16){var _17=document.createElement("div");_17.className=this.classTag+"-row";_17[_6.grid.gridViewTag]=this.id;_17[_6.grid.rowIndexTag]=_16;this.rowNodes[_16]=_17;return _17;},buildRow:function(_18,_19){this.buildRowContent(_18,_19);this.styleRow(_18,_19);},buildRowContent:function(_1a,_1b){_1b.innerHTML=this.content.generateHtml(_1a,_1a);if(this.flexCells){_1b.firstChild.style.width=this.contentWidth;}},rowRemoved:function(_1c){this.grid.edit.save(this,_1c);delete this.rowNodes[_1c];},getRowNode:function(_1d){return this.rowNodes[_1d];},getCellNode:function(_1e,_1f){var row=this.getRowNode(_1e);if(row){return this.content.getCellNode(row,_1f);}},styleRow:function(_21,_22){_22._style=_6.grid.getStyleText(_22);this.styleRowNode(_21,_22);},styleRowNode:function(_23,_24){if(_24){this.doStyleRowNode(_23,_24);}},doStyleRowNode:function(_25,_26){this.grid.styleRowNode(_25,_26);},updateRow:function(_27,_28,_29){var _2a=this.getRowNode(_27);if(_2a){_2a.style.height="";this.buildRow(_27,_2a);}return _2a;},updateRowStyles:function(_2b){this.styleRowNode(_2b,this.getRowNode(_2b));},lastTop:0,firstScroll:0,doscroll:function(_2c){var _2d=_4._isBodyLtr();if(this.firstScroll<2){if((!_2d&&this.firstScroll==1)||(_2d&&this.firstScroll==0)){var s=_4.marginBox(this.headerNodeContainer);if(_4.isIE){this.headerNodeContainer.style.width=s.w+this.getScrollbarWidth()+"px";}else{if(_4.isMoz){this.headerNodeContainer.style.width=s.w-this.getScrollbarWidth()+"px";if(_2d){this.scrollboxNode.scrollLeft=this.scrollboxNode.scrollWidth-this.scrollboxNode.clientWidth;}else{this.scrollboxNode.scrollLeft=this.scrollboxNode.clientWidth-this.scrollboxNode.scrollWidth;}}}}this.firstScroll++;}this.headerNode.scrollLeft=this.scrollboxNode.scrollLeft;var top=this.scrollboxNode.scrollTop;if(top!=this.lastTop){this.grid.scrollTo(top);}},setScrollTop:function(_30){this.lastTop=_30;this.scrollboxNode.scrollTop=_30;return this.scrollboxNode.scrollTop;},doContentEvent:function(e){if(this.content.decorateEvent(e)){this.grid.onContentEvent(e);}},doHeaderEvent:function(e){if(this.header.decorateEvent(e)){this.grid.onHeaderEvent(e);}},dispatchContentEvent:function(e){return this.content.dispatchEvent(e);},dispatchHeaderEvent:function(e){return this.header.dispatchEvent(e);},setColWidth:function(_35,_36){this.grid.setCellWidth(_35,_36+"px");},update:function(){var _37=this.scrollboxNode.scrollLeft;this.content.update();this.grid.update();this.scrollboxNode.scrollLeft=_37;this.headerNode.scrollLeft=_37;}});}}};});